{% extends "layouts/base.html" %}

{% block stylesheets %}{% endblock stylesheets %}

{% block title %} Chat {% endblock %}

{% load crispy_forms_tags %}

{% block content %}

        <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /> -->
        <section class="pcoded-main-container">
            <div class="pcoded-wrapper">
    
                <div class="pcoded-content">
                    <div class="pcoded-inner-content">
                        <!-- [ breadcrumb ] start -->
                        <div class="page-header">
                            <div class="page-block">
                                <div class="row align-items-center">
                                    <div class="col-md-12">
                                        <div class="page-header-title">
                                            <h5 class="m-b-10">{{ _("Dashboard Tables") }}</h5>
                                        </div>
                                        <ul class="breadcrumb">
                                            <li class="breadcrumb-item"><a href="{% url 'dashboard:index' %}"><i class="feather icon-home"></i></a></li>
                                            <li class="breadcrumb-item"><a href="#!">{{ _("Tables") }}</a></li>
                                            <li class="breadcrumb-item"><a href="#">{{ _("Chats") }}</a></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- [ breadcrumb ] end -->
                        <div class="main-body">
                            <div class="page-wrapper">
                                <div class="row">
                                    <div class="col-xl-12">
                                        <div class="card">
                                            <div class="card-header">
                                                <h5>{{ _("Chat") }} {{ chat_room.title }}</h5>
                                                <span class="d-block m-t-5"></span>
                                                {% if chat_room.opened %}
                                                <a class="btn btn-secondary" href="{% url 'dashboard:chat_status_change' pk=chat_room.pk %}">Close</a>
                                                {% else %}
                                                <a class="btn btn-primary" href="{% url 'dashboard:chat_status_change' pk=chat_room.pk %}">Open</a>
                                                {% endif %}
                                            </div>
    
                                            <div class="card-block">
                                                <div id="messages-list" class="messages">
                                                    {% for chat_message in chat_messages %}
                                                        <div class="message {% if chat_message.owner == request.user %}sent{% else %}received{% endif %}">
                                                            <div class="message-info">
                                                                {{ chat_message.owner.username }}
                                                            </div>
                                                            <div class="message-content">
                                                                {{ chat_message.msg }}
                                                            </div>
                                                        </div>
                                                    {% endfor %}
                                                </div>
                                                <form class="message-form" method="POST">
                                                    {% csrf_token %}
                                                    {% crispy form %}
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <style>
            .chat-rooms {
                background-color: #f8f9fa;
                border-right: 1px solid #dee2e6;
                padding: 20px;
            }
            
            .chat-main {
                padding: 20px;
            }
            
            .messages {
                border: 1px solid #ccc;
                padding: 10px;
                max-height: 400px;
                overflow-y: scroll;
            }
            
            .message {
                display: flex;
                margin: 10px 0;
            }
            .sent {
                justify-content: flex-end;
            }
            
            .received {
                justify-content: flex-start;
            }

            .message-content {
                background-color: #007bff;
                color: white;
                padding: 10px;
                border-radius: 10px;
            }
            
            .message-info {
                font-size: 12px;
                color: #666;
                padding-right: 10px;
            }
            
            .message-form {
                margin-top: 10px;
            }
            
            .message-form input {
                flex: 1;
                margin-right: 10px;
            }
            .send-btn {
                width: 200px; /* Set the desired width */
                height: 70px; /* Set the desired height */
                font-size: 18px; /* Adjust font size as needed */
                /* Add any other custom styling properties you want */
            }
        </style>
        
{% endblock %}
{% block javascripts %}
<script>
    $(document).ready(function(){
        $('#messages-list').scrollTop($('#messages-list').height())
    })
</script>
{% endblock %}