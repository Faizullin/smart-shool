"use strict";(self.webpackChunkfrontend_admin=self.webpackChunkfrontend_admin||[]).push([[873],{9873:(te,C,d)=>{d.d(C,{D:()=>W});var r=d(4341),_=d(2583),u=d(6354),e=d(7705),h=d(779),m=d(1626);let g=(()=>{class n{constructor(t){this.http=t}getQuizes(t){return this.http.get("/api/s/quizzes/",{params:{...t}}).pipe((0,u.T)(i=>{const s=i.count||0;return{results:(i.results||[]).map(function(l){return{...l}}),count:s}}))}getQuestions(t,i){return this.http.get(`/api/s/quizzes/${t}/questions/`,{params:{...i}}).pipe((0,u.T)(o=>{const l=o.count||0;return{results:(o.results||[]).map(function(f){return{...f}}),count:l}}))}getQuiz(t){return this.http.get(`/api/s/quizzes/${t}`).pipe((0,u.T)(i=>({...i})))}createQuiz(t){return this.http.post("/api/s/quizzes/",t).pipe((0,u.T)(i=>({...i})))}updateQuiz(t,i){return this.http.patch(`/api/s/quizzes/${t}/`,i).pipe((0,u.T)(o=>({...o})))}addQuestion(t,i){return this.http.post(`/api/s/quizzes/${t}/questions/`,i).pipe((0,u.T)(o=>({...o})))}deleteQuestion(t,i){return this.http.delete(`/api/s/quizzes/${t}/questions/${i}/`)}getQuestion(t,i){return this.http.get(`/api/s/quizzes/${t}/questions/${i}/`).pipe((0,u.T)(o=>({...o})))}updateQuestion(t,i,o){return this.http.patch(`/api/s/quizzes/${t}/questions/${i}/`,o).pipe((0,u.T)(s=>({...s})))}static{this.\u0275fac=function(i){return new(i||n)(e.KVO(m.Qq))}}static{this.\u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var p=d(177),a=d(4703),b=d(6243);function v(n,c){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"button",10),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.onCreateOpenClick())}),e.EFF(2," Create "),e.k0s(),e.bVm()}}function I(n,c){1&n&&(e.j41(0,"div")(1,"div",11),e.nrm(2,"i",12),e.j41(3,"span",13),e.EFF(4,"Loading..."),e.k0s()()())}function k(n,c){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"th",18),e.bIt("click",function(){const s=e.eBV(t).$implicit,l=e.XpG(2);return e.Njj(l.onSortChange(s.field))}),e.EFF(2),e.k0s(),e.bVm()}if(2&n){const t=c.$implicit;e.R7$(2),e.JRh(t.header)}}function F(n,c){1&n&&(e.qex(0),e.j41(1,"th"),e.EFF(2,"Actions"),e.k0s(),e.bVm())}function E(n,c){if(1&n&&(e.qex(0),e.nrm(1,"td",19),e.bVm()),2&n){const t=c.$implicit,i=e.XpG().$implicit;e.R7$(1),e.Y8G("innerHtml",t.cellTemplate?t.cellTemplate(i):t.field?i[t.field]:"any",e.npT)}}function z(n,c){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"td",20)(2,"button",21),e.bIt("click",function(){e.eBV(t);const o=e.XpG().$implicit,s=e.XpG(2);return e.Njj(s.onEditOpenClick(o))}),e.EFF(3," Edit "),e.k0s(),e.j41(4,"button",22),e.bIt("click",function(){e.eBV(t);const o=e.XpG().$implicit,s=e.XpG(2);return e.Njj(s.onDelete(o))}),e.EFF(5," Delete "),e.k0s()(),e.bVm()}}function T(n,c){if(1&n&&(e.j41(0,"tr"),e.DNE(1,E,2,1,"ng-container",15),e.DNE(2,z,6,0,"ng-container",7),e.k0s()),2&n){const t=e.XpG(2);e.R7$(1),e.Y8G("ngForOf",t.columns),e.R7$(1),e.Y8G("ngIf",t.useActions)}}function S(n,c){if(1&n){const t=e.RV6();e.j41(0,"table",14)(1,"thead")(2,"tr"),e.DNE(3,k,3,1,"ng-container",15),e.DNE(4,F,3,0,"ng-container",7),e.k0s()(),e.j41(5,"tbody"),e.DNE(6,T,3,2,"tr",15),e.k0s()(),e.j41(7,"div",16)(8,"app-smart-pagination",17),e.bIt("pageChanged",function(o){e.eBV(t);const s=e.XpG();return e.Njj(s.onPageChange(o))})("pageSizeChanged",function(o){e.eBV(t);const s=e.XpG();return e.Njj(s.onPageSizeChange(o))}),e.k0s()()}if(2&n){const t=e.XpG();e.Y8G("hover",!0)("responsive",!0)("striped",!0),e.R7$(3),e.Y8G("ngForOf",t.columns),e.R7$(1),e.Y8G("ngIf",t.useActions),e.R7$(2),e.Y8G("ngForOf",t.data),e.R7$(2),e.Y8G("page",t.page)("pageSize",t.pageSize)("pageSizeOptions",t.pageSizeOptions)("totalPages",t.totalPages)}}let R=(()=>{class n{constructor(){this.data=[],this.columns=[],this.pageSizeOptions=[1,10,25,50,100],this.filterText="",this.pageSize=10,this.page=1,this.totalPages=1,this.paginationRangeSize=4,this.useActions=!0,this.createAction=!1,this.loading=!1,this.sortChanged=new e.bkB,this.filterChanged=new e.bkB,this.pageSizeChanged=new e.bkB,this.pageChanged=new e.bkB,this.editOpened=new e.bkB,this.deleteOpened=new e.bkB}onSortChange(t){this.sortChanged.emit(`${t}`)}onFilterChange(t){this.filterChanged.emit(t)}onPageSizeChange(t){this.pageSizeChanged.emit(t)}onPageChange(t){this.pageChanged.emit(t)}onCreateOpenClick(){this.editOpened.emit()}onEditOpenClick(t){this.editOpened.emit(t)}onDelete(t){this.deleteOpened.emit(t)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-smart-table"]],inputs:{data:"data",columns:"columns",pageSizeOptions:"pageSizeOptions",filterText:"filterText",pageSize:"pageSize",page:"page",totalPages:"totalPages",paginationRangeSize:"paginationRangeSize",useActions:"useActions",createAction:"createAction",loading:"loading"},outputs:{sortChanged:"sortChanged",filterChanged:"filterChanged",pageSizeChanged:"pageSizeChanged",pageChanged:"pageChanged",editOpened:"editOpened",deleteOpened:"deleteOpened"},decls:13,vars:4,consts:[[1,"mb-3"],[1,"row"],["xs","12","md","6"],["cLabel","","for","inputEmail-1"],["cFormControl","","id","inputEmail-1","type","text",3,"ngModel","ngModelChange"],["cFormText",""],["xs","12","md","6",1,"d-flex","align-items-center"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["tableContent",""],["cButton","","color","primary",3,"click"],[1,"fade","show",2,"text-align","center","padding-top","calc(100% / 2)","height","100%"],[1,"spinner-grow","spinner-grow-sm"],[1,"m-1"],["align","middle","cTable","",1,"mb-0","border",3,"hover","responsive","striped"],[4,"ngFor","ngForOf"],[1,"mt-3"],[3,"page","pageSize","pageSizeOptions","totalPages","pageChanged","pageSizeChanged"],[3,"click"],[3,"innerHtml"],[1,""],["cButton","","color","primary",1,"mx-3","my-2",3,"click"],["cButton","","color","danger",3,"click"]],template:function(i,o){if(1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"c-col",2)(3,"label",3),e.EFF(4,"Search"),e.k0s(),e.j41(5,"input",4),e.bIt("ngModelChange",function(l){return o.filterText=l})("ngModelChange",function(){return o.onFilterChange(o.filterText)}),e.k0s(),e.j41(6,"div",5),e.EFF(7,"We can search by any field"),e.k0s()(),e.j41(8,"c-col",6),e.DNE(9,v,3,0,"ng-container",7),e.k0s()()(),e.DNE(10,I,5,0,"div",8),e.DNE(11,S,9,10,"ng-template",null,9,e.C5r)),2&i){const s=e.sdS(12);e.R7$(5),e.Y8G("ngModel",o.filterText),e.R7$(4),e.Y8G("ngIf",o.createAction),e.R7$(1),e.Y8G("ngIf",o.loading)("ngIfElse",s)}},dependencies:[p.Sq,p.bT,a.gLf,r.me,r.BC,a._fv,a.l_X,a.YJZ,a.TF2,r.vS,a.sZU,b.F]})}}return n})();var j=d(7541);function Q(n,c){1&n&&(e.j41(0,"c-form-feedback",11),e.EFF(1," Prompt is required. "),e.k0s()),2&n&&e.Y8G("valid",!1)}function x(n,c){if(1&n&&(e.j41(0,"div"),e.DNE(1,Q,2,1,"c-form-feedback",10),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.Y8G("ngIf",t.formControl.prompt.errors.required&&t.formControl.prompt.touched)}}function G(n,c){if(1&n){const t=e.RV6();e.j41(0,"div",1)(1,"div",12)(2,"label",13),e.EFF(3,"Content"),e.k0s(),e.j41(4,"c-row")(5,"c-col"),e.nrm(6,"input",14),e.k0s(),e.j41(7,"c-col")(8,"c-form-check"),e.nrm(9,"input",15),e.j41(10,"label",16),e.EFF(11,"Correct"),e.k0s()()(),e.j41(12,"c-col")(13,"button",17),e.bIt("click",function(){const s=e.eBV(t).index,l=e.XpG();return e.Njj(l.onRemoveQuestionAnswer(s))}),e.EFF(14,"Remove"),e.k0s()()()()()}if(2&n){const t=c.index;e.R7$(1),e.Y8G("formGroupName",t),e.R7$(1),e.Mz_("for","answerContent",t,""),e.R7$(4),e.Y8G("id","answerContent"+t),e.R7$(3),e.Y8G("id","correctAnswer"+t),e.R7$(1),e.Mz_("for","correctAnswer",t,"")}}let q=(()=>{class n extends _.H{constructor(t,i,o,s){super(t,i,o),this.quizService=s,this.editInstance=null,this.editQuizInstanceId=null,this.onRequestSuccess=new e.bkB}ngOnInit(){this.form=this.fb.group({prompt:new r.MJ("",r.k0.required),choices:this.fb.array([])})}ngOnChanges(t){t.editInstance&&!t.editInstance.firstChange&&(null===t.editInstance.currentValue?(this.editInstance=null,this.form.reset()):(this.editInstance=t.editInstance.currentValue,this.form.reset()),this.patchFormValue({}))}patchFormValue(t){if(null!==this.editInstance){const i=this.form.get("choices");for(this.form.patchValue({prompt:this.editInstance.prompt});0!==i.length;)i.removeAt(0);this.editInstance.choices.forEach(o=>{i.push(this.fb.group({content:o.content,correct:o.correct}))})}}onRemoveQuestionAnswer(t){this.form.get("choices").removeAt(t)}get questionAnswers(){return this.form.get("choices")}addAnswer(){this.form.controls.choices.push(this.fb.group({content:["",r.k0.required],correct:[!1]}))}fetchCreateRequest(t){return this.quizService.addQuestion(this.editQuizInstanceId,t)}fetchUpdateRequest(t,i){return this.quizService.updateQuestion(this.editQuizInstanceId,this.editInstance.id,i)}getPreparedEditData(t){for(let i=0;i<t.choices.length;i++)t.choices[i].correct=!!t.choices[i].correct;return t.type="o",t}afterRequestSuccess(t){this.loading.post=!1,this.validationErrors={},this.form.reset(),this.onRequestSuccess.emit(t)}afterRequestError(t){if(this.loading.post=!1,400==t.status||422==t.status){const i={...t.error};this.validationErrors=i}}static{this.\u0275fac=function(i){return new(i||n)(e.rXU(r.ok),e.rXU(h.I8),e.rXU(m.Qq),e.rXU(g))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["dashboard-question-open-ended-form"]],inputs:{editInstance:"editInstance",mode:"mode",editQuizInstanceId:"editQuizInstanceId"},outputs:{onRequestSuccess:"onRequestSuccess"},features:[e.Vt3,e.OA$],decls:16,vars:4,consts:[["novalidate","",3,"formGroup","ngSubmit"],[1,"form-group"],["cLabel",""],["cFormControl","","name","prompt","formControlName","prompt",1,"form-control"],[4,"ngIf"],["formArrayName","choices",1,"mt-3"],["class","form-group",4,"ngFor","ngForOf"],[1,"form-group","mt-3"],["cButton","","color","default","type","button",1,"mr-4",3,"click"],["cButton","","color","primary","type","submit",3,"disabled"],["class","d-block",3,"valid",4,"ngIf"],[1,"d-block",3,"valid"],[3,"formGroupName"],["cLabel","col",3,"for"],["type","text","cFormControl","","formControlName","content",3,"id"],["cFormCheckInput","","formControlName","correct","type","checkbox",3,"id"],["cFormCheckLabel","",3,"for"],["type","button","cButton","","color","danger",3,"click"]],template:function(i,o){1&i&&(e.j41(0,"form",0),e.bIt("ngSubmit",function(){return o.onSave()}),e.j41(1,"div",1)(2,"label",2),e.EFF(3,"Prompt"),e.k0s(),e.j41(4,"c-row")(5,"c-col"),e.nrm(6,"input",3),e.k0s(),e.nrm(7,"c-col"),e.k0s(),e.DNE(8,x,2,1,"div",4),e.k0s(),e.j41(9,"div",5),e.DNE(10,G,15,5,"div",6),e.k0s(),e.j41(11,"div",7)(12,"button",8),e.bIt("click",function(){return o.addAnswer()}),e.EFF(13," Add Answer "),e.k0s(),e.j41(14,"button",9),e.EFF(15," Save Question "),e.k0s()()()),2&i&&(e.Y8G("formGroup",o.form),e.R7$(8),e.Y8G("ngIf",o.formControl.prompt.errors),e.R7$(2),e.Y8G("ngForOf",o.questionAnswers.controls),e.R7$(4),e.Y8G("disabled",o.form.invalid))},dependencies:[p.Sq,p.bT,a.gLf,a.oMR,r.qT,r.me,r.Zm,r.BC,r.cb,r.j4,r.JD,r.$R,r.v8,a._fv,a.akk,a.cy2,a.iQ3,a.l_X,a.XW7,a.YJZ]})}}return n})();function $(n,c){1&n&&(e.j41(0,"c-form-feedback",11),e.EFF(1," Prompt is required. "),e.k0s()),2&n&&e.Y8G("valid",!1)}function y(n,c){if(1&n&&(e.j41(0,"div"),e.DNE(1,$,2,1,"c-form-feedback",10),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.Y8G("ngIf",t.formControl.prompt.errors.required&&t.formControl.prompt.touched)}}function N(n,c){if(1&n){const t=e.RV6();e.j41(0,"div",1)(1,"div",12)(2,"label",13),e.EFF(3,"Content"),e.k0s(),e.j41(4,"c-row")(5,"c-col"),e.nrm(6,"input",14),e.k0s(),e.j41(7,"c-col")(8,"c-form-check"),e.nrm(9,"input",15),e.j41(10,"label",16),e.EFF(11,"Correct"),e.k0s()()(),e.j41(12,"c-col")(13,"button",17),e.bIt("click",function(){const s=e.eBV(t).index,l=e.XpG();return e.Njj(l.onRemoveQuestionAnswer(s))}),e.EFF(14,"Remove"),e.k0s()()()()()}if(2&n){const t=c.index;e.R7$(1),e.Y8G("formGroupName",t),e.R7$(1),e.Mz_("for","answerContent",t,""),e.R7$(4),e.Y8G("id","answerContent"+t),e.R7$(3),e.Y8G("id","correctAnswer"+t),e.R7$(1),e.Mz_("for","correctAnswer",t,"")}}let Y=(()=>{class n extends _.H{constructor(t,i,o,s){super(t,i,o),this.quizService=s,this.editInstance=null,this.editQuizInstanceId=null,this.onRequestSuccess=new e.bkB}ngOnInit(){this.form=this.fb.group({prompt:new r.MJ("",r.k0.required),choices:this.fb.array([])})}ngOnChanges(t){t.editInstance&&!t.editInstance.firstChange&&(null===t.editInstance.currentValue?(this.editInstance=null,this.form.reset()):(this.editInstance=t.editInstance.currentValue,this.form.reset()),this.patchFormValue({}))}patchFormValue(t){if(null!==this.editInstance){const i=this.form.get("choices");for(this.form.patchValue({prompt:this.editInstance.prompt});0!==i.length;)i.removeAt(0);this.editInstance.choices.forEach(o=>{i.push(this.fb.group({content:o.content,correct:o.correct}))})}}onRemoveQuestionAnswer(t){this.form.get("choices").removeAt(t)}get questionAnswers(){return this.form.get("choices")}addAnswer(){this.form.controls.choices.push(this.fb.group({content:["",r.k0.required],correct:[!1]}))}fetchCreateRequest(t){return this.quizService.addQuestion(this.editQuizInstanceId,t)}fetchUpdateRequest(t,i){return this.quizService.updateQuestion(this.editQuizInstanceId,this.editInstance.id,i)}getPreparedEditData(t){for(let i=0;i<t.choices.length;i++)t.choices[i].correct=!!t.choices[i].correct;return t.type="c",t}afterRequestSuccess(t){this.loading.post=!1,this.validationErrors={},this.form.reset(),this.onRequestSuccess.emit(t)}afterRequestError(t){if(this.loading.post=!1,400==t.status||422==t.status){const i={...t.error};this.validationErrors=i}}static{this.\u0275fac=function(i){return new(i||n)(e.rXU(r.ok),e.rXU(h.I8),e.rXU(m.Qq),e.rXU(g))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["dashboard-question-closed-ended-form"]],inputs:{editInstance:"editInstance",editQuizInstanceId:"editQuizInstanceId"},outputs:{onRequestSuccess:"onRequestSuccess"},features:[e.Vt3,e.OA$],decls:16,vars:4,consts:[["novalidate","",3,"formGroup","ngSubmit"],[1,"form-group"],["cLabel",""],["cFormControl","","name","prompt","formControlName","prompt",1,"form-control"],[4,"ngIf"],["formArrayName","choices",1,"mt-3"],["class","form-group",4,"ngFor","ngForOf"],[1,"form-group","mt-3"],["cButton","","color","default","type","button",1,"mr-4",3,"click"],["cButton","","color","primary","type","submit",3,"disabled"],["class","d-block",3,"valid",4,"ngIf"],[1,"d-block",3,"valid"],[3,"formGroupName"],["cLabel","col",3,"for"],["type","text","cFormControl","","formControlName","content",3,"id"],["cFormCheckInput","","formControlName","correct","type","checkbox",3,"id"],["cFormCheckLabel","",3,"for"],["type","button","cButton","","color","danger",3,"click"]],template:function(i,o){1&i&&(e.j41(0,"form",0),e.bIt("ngSubmit",function(){return o.onSave()}),e.j41(1,"div",1)(2,"label",2),e.EFF(3,"Prompt"),e.k0s(),e.j41(4,"c-row")(5,"c-col"),e.nrm(6,"input",3),e.k0s(),e.nrm(7,"c-col"),e.k0s(),e.DNE(8,y,2,1,"div",4),e.k0s(),e.j41(9,"div",5),e.DNE(10,N,15,5,"div",6),e.k0s(),e.j41(11,"div",7)(12,"button",8),e.bIt("click",function(){return o.addAnswer()}),e.EFF(13," Add Answer "),e.k0s(),e.j41(14,"button",9),e.EFF(15," Save Question "),e.k0s()()()),2&i&&(e.Y8G("formGroup",o.form),e.R7$(8),e.Y8G("ngIf",o.formControl.prompt.errors),e.R7$(2),e.Y8G("ngForOf",o.questionAnswers.controls),e.R7$(4),e.Y8G("disabled",o.form.invalid))},dependencies:[p.Sq,p.bT,a.gLf,a.oMR,r.qT,r.me,r.Zm,r.BC,r.cb,r.j4,r.JD,r.$R,r.v8,a._fv,a.akk,a.cy2,a.iQ3,a.l_X,a.XW7,a.YJZ]})}}return n})();function O(n,c){1&n&&(e.j41(0,"c-form-feedback",13),e.EFF(1," Title is required. "),e.k0s()),2&n&&e.Y8G("valid",!1)}function V(n,c){if(1&n&&(e.j41(0,"div"),e.DNE(1,O,2,1,"c-form-feedback",6),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.Y8G("ngIf",t.formControl.title.errors.required&&t.formControl.title.touched)}}function X(n,c){if(1&n&&(e.j41(0,"c-form-feedback",13),e.EFF(1),e.k0s()),2&n){const t=e.XpG();e.Y8G("valid",!1),e.R7$(1),e.SpI(" ",t.validationErrors.title," ")}}function w(n,c){1&n&&(e.j41(0,"c-form-feedback",13),e.EFF(1," Exam is required. "),e.k0s()),2&n&&e.Y8G("valid",!1)}function B(n,c){if(1&n&&(e.j41(0,"div"),e.DNE(1,w,2,1,"c-form-feedback",6),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.Y8G("ngIf",t.formControl.exam.errors.required&&t.formControl.exam.touched)}}function D(n,c){if(1&n&&(e.j41(0,"c-form-feedback",13),e.EFF(1),e.k0s()),2&n){const t=e.XpG();e.Y8G("valid",!1),e.R7$(1),e.SpI(" ",t.validationErrors.exam," ")}}function A(n,c){if(1&n){const t=e.RV6();e.j41(0,"div")(1,"dashboard-question-closed-ended-form",20),e.bIt("onRequestSuccess",function(o){e.eBV(t);const s=e.XpG(3);return e.Njj(s.onSuccessfullQuestionSubmit(o))}),e.k0s()()}if(2&n){const t=e.XpG(3);e.R7$(1),e.Y8G("editQuizInstanceId",t.editInstance.id)("editInstance",t.editQuestionInstance)}}function P(n,c){if(1&n){const t=e.RV6();e.j41(0,"div")(1,"dashboard-question-open-ended-form",20),e.bIt("onRequestSuccess",function(o){e.eBV(t);const s=e.XpG(3);return e.Njj(s.onSuccessfullQuestionSubmit(o))}),e.k0s()()}if(2&n){const t=e.XpG(3);e.R7$(1),e.Y8G("editQuizInstanceId",t.editInstance.id)("editInstance",t.editQuestionInstance)}}function M(n,c){if(1&n&&(e.j41(0,"div",19),e.DNE(1,A,2,2,"div",5),e.DNE(2,P,2,2,"div",5),e.k0s()),2&n){const t=e.XpG(2);e.R7$(1),e.Y8G("ngIf","c"===t.selectedFormType),e.R7$(1),e.Y8G("ngIf","o"===t.selectedFormType)}}function U(n,c){if(1&n){const t=e.RV6();e.j41(0,"div")(1,"c-row")(2,"c-col")(3,"select",14),e.bIt("ngModelChange",function(o){e.eBV(t);const s=e.XpG();return e.Njj(s.selectedFormType=o)})("ngModelChange",function(o){e.eBV(t);const s=e.XpG();return e.Njj(s.selectedFormTypeChanged(o))}),e.j41(4,"option",15),e.EFF(5,"Closed-ended"),e.k0s(),e.j41(6,"option",16),e.EFF(7,"Open-ended"),e.k0s()()(),e.j41(8,"c-col")(9,"button",17),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.onNewQuestionClick())}),e.EFF(10," New Question "),e.k0s()()(),e.DNE(11,M,3,2,"div",18),e.k0s()}if(2&n){const t=e.XpG();e.R7$(3),e.Y8G("ngModel",t.selectedFormType),e.R7$(8),e.Y8G("ngIf",null!==t.editInstance)}}function L(n,c){1&n&&e.EFF(0," Save to add question ")}const J=function(){return[]};function H(n,c){if(1&n){const t=e.RV6();e.j41(0,"div")(1,"app-smart-table",21),e.bIt("pageSizeChanged",function(o){e.eBV(t);const s=e.XpG();return e.Njj(s.onPageSizeChange(o))})("pageChanged",function(o){e.eBV(t);const s=e.XpG();return e.Njj(s.onPageChange(o))})("deleteOpened",function(o){e.eBV(t);const s=e.XpG();return e.Njj(s.onDeleteQuestion(o))})("editOpened",function(o){e.eBV(t);const s=e.XpG();return e.Njj(s.onEditQuestionOpen(o))}),e.k0s()()}if(2&n){const t=e.XpG();e.R7$(1),e.Y8G("data",t.editInstance.questions||e.lJ4(3,J))("columns",t.columns)("totalPages",t.editInstance.questions_count)}}const Z={c:"Closed-ended",o:"Open-ended",d:"Draggable"};let W=(()=>{class n extends _.H{constructor(t,i,o,s){super(t,i,o),this.quizService=s,this.action_urls={detail:l=>`/api/s/quizzes/${l}/`,post:()=>"/api/s/quizzes/"},this.editInstance=null,this.editQuestionInstance=null,this.selectedFormType="c",this.columns=[{header:"Id",field:"id",cellTemplate:l=>`<strong>${l.id}</strong>`},{header:"Prompt",field:"prompt"},{header:"Question type",field:"type",cellTemplate:l=>`${Z[l.type]}`},{header:"Created At",field:"created_at",cellTemplate:l=>`${l.created_at}`}],this.filterParams={page:1,page_size:10,filterText:"",ordering:"id",filters:{}},this.fetchFilterRequest={exams:l=>this.http.get("/api/s/exams",{params:{...l,quiz__isnull:!0}}).pipe((0,u.T)(f=>(f.results||[]).map(function(ee){return{...ee}})))}}ngOnInit(){this.form=this.fb.group({title:["",r.k0.required],exam:[[],r.k0.required],duration_time:[0],type:[["c"],r.k0.required]}),super.ngOnInit()}selectedFormTypeChanged(t){this.editQuestionInstance=null}patchFormValue(t){null!==this.editInstance&&(this.form.patchValue({title:this.editInstance.title,exam:this.editInstance.exam?[this.editInstance.exam]:[],duration_time:this.editInstance.duration_time||0,questions:[]}),this.fetchQuizQuestions())}getPreparedEditData(t){return t.exam_id=t.exam.length>0?t.exam[0].id:null,t}fetchQuizQuestions(){null!==this.editInstance&&this.quizService.getQuestions(this.editInstance.id,{...this.filterParams,search:this.filterParams.filterText}).subscribe(t=>{this.editInstance.questions=t.results,this.editInstance.questions_count=t.count})}onSuccessfullQuestionSubmit(t){this.editQuestionInstance=null,this.fetchQuizQuestions()}getExamFilterTextField(t){return`${t.id} - ${t.exam_type}`}onPageSizeChange(t){this.filterParams.page_size=t,this.filterParams.page=1,this.fetchQuizQuestions()}onPageChange(t){this.filterParams.page=t,this.fetchQuizQuestions()}onNewQuestionClick(){this.editQuestionInstance=null}onEditQuestionOpen(t){null!==this.editInstance&&void 0!==t.id&&this.quizService.getQuestion(this.editInstance.id,t.id).subscribe({next:i=>{this.selectedFormType=i.type,this.editQuestionInstance=i}})}onDeleteQuestion(t){null!==this.editInstance&&void 0!==t.id&&this.quizService.deleteQuestion(this.editInstance.id,t.id).subscribe({next:()=>{this.editInstance?.id===t.id&&(this.editInstance=null,this.form.reset()),this.fetchQuizQuestions()}})}static{this.\u0275fac=function(i){return new(i||n)(e.rXU(r.ok),e.rXU(h.I8),e.rXU(m.Qq),e.rXU(g))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-quiz-edit"]],features:[e.Vt3],decls:25,vars:17,consts:[["cModalTitle",""],["novalidate","",3,"formGroup","submit"],[1,"form-group"],["cLabel",""],["cFormControl","","name","title","formControlName","title"],[4,"ngIf"],["class","d-block",3,"valid",4,"ngIf"],["cLabel","","for","exam"],["formControlName","exam",3,"idField","textFieldDef","allowSearchFilter","useInitialLoad","allowRemoteDataSearch","multiple","filterMethod"],["type","submit","cButton","","color","primary",1,"mt-5",3,"disabled"],[1,"my-6"],[4,"ngIf","ngIfElse"],["saveToEditQuestions",""],[1,"d-block",3,"valid"],["cSelect","",3,"ngModel","ngModelChange"],["value","c"],["value","o"],["type","button","cButton","","color","primary",3,"click"],["class","mt-3",4,"ngIf"],[1,"mt-3"],[3,"editQuizInstanceId","editInstance","onRequestSuccess"],[3,"data","columns","totalPages","pageSizeChanged","pageChanged","deleteOpened","editOpened"]],template:function(i,o){if(1&i&&(e.j41(0,"c-modal-header")(1,"h5",0),e.EFF(2),e.k0s()(),e.j41(3,"c-modal-body")(4,"form",1),e.bIt("submit",function(){return o.onSave()}),e.j41(5,"div",2)(6,"label",3),e.EFF(7,"Title"),e.k0s(),e.nrm(8,"input",4),e.DNE(9,V,2,1,"div",5),e.DNE(10,X,2,2,"c-form-feedback",6),e.k0s(),e.j41(11,"div",2)(12,"label",7),e.EFF(13,"Exam"),e.k0s(),e.nrm(14,"app-filterable-multiselect",8),e.DNE(15,B,2,1,"div",5),e.DNE(16,D,2,2,"c-form-feedback",6),e.k0s(),e.j41(17,"button",9),e.EFF(18," Save "),e.k0s()(),e.nrm(19,"hr",10),e.DNE(20,U,12,2,"div",11),e.DNE(21,L,1,0,"ng-template",null,12,e.C5r),e.nrm(23,"hr",10),e.DNE(24,H,2,4,"div",5),e.k0s()),2&i){const s=e.sdS(22);e.R7$(2),e.SpI("Quiz #",null==o.editInstance?null:o.editInstance.id,""),e.R7$(2),e.Y8G("formGroup",o.form),e.R7$(5),e.Y8G("ngIf",o.formControl.title.errors),e.R7$(1),e.Y8G("ngIf",o.validationErrors.title),e.R7$(4),e.Y8G("idField","id")("textFieldDef",o.getExamFilterTextField)("allowSearchFilter",!0)("useInitialLoad",!0)("allowRemoteDataSearch",!0)("multiple",!1)("filterMethod",o.fetchFilterRequest.exams),e.R7$(1),e.Y8G("ngIf",o.formControl.exam.errors),e.R7$(1),e.Y8G("ngIf",o.validationErrors.exam),e.R7$(1),e.Y8G("disabled",o.form.invalid),e.R7$(3),e.Y8G("ngIf",o.editInstance)("ngIfElse",s),e.R7$(4),e.Y8G("ngIf",o.editInstance)}},dependencies:[p.bT,a.gLf,a.oMR,r.qT,r.xH,r.y7,r.me,r.wz,r.BC,r.cb,r.j4,r.JD,a._fv,a.l_X,a.XW7,a.YJZ,a.wPz,r.vS,a.Jyz,a.epl,a.L$K,R,j.D,q,Y]})}}return n})()}}]);