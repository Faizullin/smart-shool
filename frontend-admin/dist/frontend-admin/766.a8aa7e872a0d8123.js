"use strict";(self.webpackChunkfrontend_admin=self.webpackChunkfrontend_admin||[]).push([[766],{6766:(Ae,x,l)=>{l.r(x),l.d(x,{ArticleModule:()=>Oe});var m=l(177),d=l(4341),g=l(4559),r=l(4703),y=l(4662),C=l(779),O=l(9304),A=l(337),f=l(4062),e=l(7705),w=l(3726),D=l(6977),U=l(1594),h=l(6354),V=l(4412),Y=l(5964),X=l(5558),B=l(1413),L=l(6129);class K extends B.B{constructor(s=1/0,t=1/0,i=L.U){super(),this._bufferSize=s,this._windowTime=t,this._timestampProvider=i,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,s),this._windowTime=Math.max(1,t)}next(s){const{isStopped:t,_buffer:i,_infiniteTimeWindow:o,_timestampProvider:a,_windowTime:c}=this;t||(i.push(s),!o&&i.push(a.now()+c)),this._trimBuffer(),super.next(s)}_subscribe(s){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(s),{_infiniteTimeWindow:i,_buffer:o}=this,a=o.slice();for(let c=0;c<a.length&&!s.closed;c+=i?1:2)s.next(a[c]);return this._checkFinalizedStatuses(s),t}_trimBuffer(){const{_bufferSize:s,_timestampProvider:t,_buffer:i,_infiniteTimeWindow:o}=this,a=(o?1:2)*s;if(s<1/0&&a<i.length&&i.splice(0,i.length-a),!o){const c=t.now();let u=0;for(let p=1;p<i.length&&i[p]<=c;p+=2)u=p;u&&i.splice(0,u+1)}}}var z=l(7647);const _=()=>{const n=typeof window<"u"?window:void 0;return n&&n.tinymce?n.tinymce:null};let J=(()=>{class n{onBeforePaste=new e.bkB;onBlur=new e.bkB;onClick=new e.bkB;onCompositionEnd=new e.bkB;onCompositionStart=new e.bkB;onCompositionUpdate=new e.bkB;onContextMenu=new e.bkB;onCopy=new e.bkB;onCut=new e.bkB;onDblclick=new e.bkB;onDrag=new e.bkB;onDragDrop=new e.bkB;onDragEnd=new e.bkB;onDragGesture=new e.bkB;onDragOver=new e.bkB;onDrop=new e.bkB;onFocus=new e.bkB;onFocusIn=new e.bkB;onFocusOut=new e.bkB;onKeyDown=new e.bkB;onKeyPress=new e.bkB;onKeyUp=new e.bkB;onMouseDown=new e.bkB;onMouseEnter=new e.bkB;onMouseLeave=new e.bkB;onMouseMove=new e.bkB;onMouseOut=new e.bkB;onMouseOver=new e.bkB;onMouseUp=new e.bkB;onPaste=new e.bkB;onSelectionChange=new e.bkB;onActivate=new e.bkB;onAddUndo=new e.bkB;onBeforeAddUndo=new e.bkB;onBeforeExecCommand=new e.bkB;onBeforeGetContent=new e.bkB;onBeforeRenderUI=new e.bkB;onBeforeSetContent=new e.bkB;onChange=new e.bkB;onClearUndos=new e.bkB;onDeactivate=new e.bkB;onDirty=new e.bkB;onExecCommand=new e.bkB;onGetContent=new e.bkB;onHide=new e.bkB;onInit=new e.bkB;onInput=new e.bkB;onInitNgModel=new e.bkB;onLoadContent=new e.bkB;onNodeChange=new e.bkB;onPostProcess=new e.bkB;onPostRender=new e.bkB;onPreInit=new e.bkB;onPreProcess=new e.bkB;onProgressState=new e.bkB;onRedo=new e.bkB;onRemove=new e.bkB;onReset=new e.bkB;onResizeEditor=new e.bkB;onSaveContent=new e.bkB;onSetAttrib=new e.bkB;onObjectResizeStart=new e.bkB;onObjectResized=new e.bkB;onObjectSelected=new e.bkB;onSetContent=new e.bkB;onShow=new e.bkB;onSubmit=new e.bkB;onUndo=new e.bkB;onVisualAid=new e.bkB;static \u0275fac=function(i){return new(i||n)};static \u0275dir=e.FsC({type:n,outputs:{onBeforePaste:"onBeforePaste",onBlur:"onBlur",onClick:"onClick",onCompositionEnd:"onCompositionEnd",onCompositionStart:"onCompositionStart",onCompositionUpdate:"onCompositionUpdate",onContextMenu:"onContextMenu",onCopy:"onCopy",onCut:"onCut",onDblclick:"onDblclick",onDrag:"onDrag",onDragDrop:"onDragDrop",onDragEnd:"onDragEnd",onDragGesture:"onDragGesture",onDragOver:"onDragOver",onDrop:"onDrop",onFocus:"onFocus",onFocusIn:"onFocusIn",onFocusOut:"onFocusOut",onKeyDown:"onKeyDown",onKeyPress:"onKeyPress",onKeyUp:"onKeyUp",onMouseDown:"onMouseDown",onMouseEnter:"onMouseEnter",onMouseLeave:"onMouseLeave",onMouseMove:"onMouseMove",onMouseOut:"onMouseOut",onMouseOver:"onMouseOver",onMouseUp:"onMouseUp",onPaste:"onPaste",onSelectionChange:"onSelectionChange",onActivate:"onActivate",onAddUndo:"onAddUndo",onBeforeAddUndo:"onBeforeAddUndo",onBeforeExecCommand:"onBeforeExecCommand",onBeforeGetContent:"onBeforeGetContent",onBeforeRenderUI:"onBeforeRenderUI",onBeforeSetContent:"onBeforeSetContent",onChange:"onChange",onClearUndos:"onClearUndos",onDeactivate:"onDeactivate",onDirty:"onDirty",onExecCommand:"onExecCommand",onGetContent:"onGetContent",onHide:"onHide",onInit:"onInit",onInput:"onInput",onInitNgModel:"onInitNgModel",onLoadContent:"onLoadContent",onNodeChange:"onNodeChange",onPostProcess:"onPostProcess",onPostRender:"onPostRender",onPreInit:"onPreInit",onPreProcess:"onPreProcess",onProgressState:"onProgressState",onRedo:"onRedo",onRemove:"onRemove",onReset:"onReset",onResizeEditor:"onResizeEditor",onSaveContent:"onSaveContent",onSetAttrib:"onSetAttrib",onObjectResizeStart:"onObjectResizeStart",onObjectResized:"onObjectResized",onObjectSelected:"onObjectSelected",onSetContent:"onSetContent",onShow:"onShow",onSubmit:"onSubmit",onUndo:"onUndo",onVisualAid:"onVisualAid"}})}return n})();const F=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onCompositionEnd","onCompositionStart","onCompositionUpdate","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onInput","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onResizeEditor","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],b=(n,s,t)=>(0,w.R)(n,s).pipe((0,D.Q)(t)),R=(n,s)=>"string"==typeof n?n.split(",").map(t=>t.trim()):Array.isArray(n)?n:s;let j=0;const S=n=>typeof n<"u"&&"textarea"===n.tagName.toLowerCase(),G=n=>typeof n>"u"||""===n?[]:Array.isArray(n)?n:n.split(" "),Q=(n,s)=>G(n).concat(G(s)),ee=()=>{},M=n=>null==n,ie=(()=>{const n=new V.t(null),s=n.pipe((0,Y.p)(Boolean),(0,X.n)(([t,i])=>{const o=t.createElement("script");return o.referrerPolicy="origin",o.type="application/javascript",o.src=i,t.head.appendChild(o),(0,w.R)(o,"load").pipe(n=>n.pipe((0,U.$)(),(0,h.T)(()=>{})))}),function H(n,s,t){let i,o=!1;return n&&"object"==typeof n?({bufferSize:i=1/0,windowTime:s=1/0,refCount:o=!1,scheduler:t}=n):i=n??1/0,(0,z.u)({connector:()=>new K(i,s,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:o})}({bufferSize:1,refCount:!0}));return{load:(...t)=>(n.getValue()||n.next(t),s),reinitialize:()=>{n.next(null)}}})(),T=new e.nKC("TINYMCE_SCRIPT_SRC"),oe={provide:d.kq,useExisting:(0,e.Rfq)(()=>v),multi:!0};let v=(()=>{class n extends J{cdRef;platformId;tinymceScriptSrc;cloudChannel="7";apiKey="no-api-key";licenseKey;init;id="";initialValue;outputFormat;inline;tagName;plugins;toolbar;modelEvents="change input undo redo";allowedEvents;ignoreEvents;set disabled(t){this._disabled=t,this._editor&&this._editor.initialized&&("function"==typeof this._editor.mode?.set?this._editor.mode.set(t?"readonly":"design"):this._editor.setMode(t?"readonly":"design"))}get disabled(){return this._disabled}get editor(){return this._editor}ngZone;_elementRef;_element;_disabled;_editor;onTouchedCallback=ee;onChangeCallback;destroy$=new B.B;constructor(t,i,o,a,c){super(),this.cdRef=o,this.platformId=a,this.tinymceScriptSrc=c,this._elementRef=t,this.ngZone=i}writeValue(t){this._editor&&this._editor.initialized?this._editor.setContent(M(t)?"":t):this.initialValue=null===t?void 0:t}registerOnChange(t){this.onChangeCallback=t}registerOnTouched(t){this.onTouchedCallback=t}setDisabledState(t){this.disabled=t}ngAfterViewInit(){(0,m.UE)(this.platformId)&&(this.id=this.id||(n=>{const t=(new Date).getTime(),i=Math.floor(1e9*Math.random());return j++,"tiny-angular_"+i+j+String(t)})(),this.inline=void 0!==this.inline?!1!==this.inline:!!this.init?.inline,this.createElement(),null!==_()?this.initialise():this._element&&this._element.ownerDocument&&ie.load(this._element.ownerDocument,this.getScriptSrc()).pipe((0,D.Q)(this.destroy$)).subscribe(this.initialise))}ngOnDestroy(){this.destroy$.next(),null!==_()&&_().remove(this._editor)}createElement(){if(this._element=document.createElement(this.inline?"string"==typeof this.tagName?this.tagName:"div":"textarea"),this._element){const i=document.getElementById(this.id);i&&i!==this._elementRef.nativeElement&&console.warn(`TinyMCE-Angular: an element with id [${this.id}] already exists. Editors with duplicate Id will not be able to mount`),this._element.id=this.id,S(this._element)&&(this._element.style.visibility="hidden"),this._elementRef.nativeElement.appendChild(this._element)}}initialise=()=>{const t={...this.init,selector:void 0,target:this._element,inline:this.inline,readonly:this.disabled,license_key:this.licenseKey,plugins:Q(this.init&&this.init.plugins,this.plugins),toolbar:this.toolbar||this.init&&this.init.toolbar,setup:i=>{this._editor=i,b(i,"init",this.destroy$).subscribe(()=>{this.initEditor(i)}),((n,s,t)=>{(n=>{const s=R(n.ignoreEvents,[]);return R(n.allowedEvents,F).filter(i=>F.includes(i)&&!s.includes(i))})(n).forEach(o=>{const a=n[o];b(s,o.substring(2),t).subscribe(c=>{(n=>n.observed||n.observers?.length>0)(a)&&n.ngZone.run(()=>a.emit({event:c,editor:s}))})})})(this,i,this.destroy$),this.init&&"function"==typeof this.init.setup&&this.init.setup(i)}};S(this._element)&&(this._element.style.visibility=""),this.ngZone.runOutsideAngular(()=>{_().init(t)})};getScriptSrc(){return M(this.tinymceScriptSrc)?`https://cdn.tiny.cloud/1/${this.apiKey}/tinymce/${this.cloudChannel}/tinymce.min.js`:this.tinymceScriptSrc}initEditor(t){b(t,"blur",this.destroy$).subscribe(()=>{this.cdRef.markForCheck(),this.ngZone.run(()=>this.onTouchedCallback())}),b(t,this.modelEvents,this.destroy$).subscribe(()=>{this.cdRef.markForCheck(),this.ngZone.run(()=>this.emitOnChange(t))}),"string"==typeof this.initialValue&&this.ngZone.run(()=>{t.setContent(this.initialValue),t.getContent()!==this.initialValue&&this.emitOnChange(t),void 0!==this.onInitNgModel&&this.onInitNgModel.emit(t)})}emitOnChange(t){this.onChangeCallback&&this.onChangeCallback(t.getContent({format:this.outputFormat}))}static \u0275fac=function(i){return new(i||n)(e.rXU(e.aKT),e.rXU(e.SKi),e.rXU(e.gRc),e.rXU(e.Agw),e.rXU(T,8))};static \u0275cmp=e.VBU({type:n,selectors:[["editor"]],inputs:{cloudChannel:"cloudChannel",apiKey:"apiKey",licenseKey:"licenseKey",init:"init",id:"id",initialValue:"initialValue",outputFormat:"outputFormat",inline:"inline",tagName:"tagName",plugins:"plugins",toolbar:"toolbar",modelEvents:"modelEvents",allowedEvents:"allowedEvents",ignoreEvents:"ignoreEvents",disabled:"disabled"},standalone:!0,features:[e.Jv_([oe]),e.Vt3,e.aNF],decls:0,vars:0,template:function(i,o){},dependencies:[m.MD,d.YN],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0})}return n})(),se=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=e.$C({type:n});static \u0275inj=e.G2t({imports:[v]})}return n})();var ae=l(712),I=l(2583),E=l(1626),re=l(7541);function le(n,s){1&n&&(e.qex(0),e.j41(1,"div",2),e.nrm(2,"c-spinner",3),e.k0s(),e.bVm())}function ce(n,s){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"button",6),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.createInstance())}),e.EFF(2," Create "),e.k0s(),e.bVm()}if(2&n){const t=e.XpG(2);e.R7$(1),e.Y8G("disabled",t.loading.post)}}function de(n,s){if(1&n&&(e.j41(0,"c-form-feedback",15),e.EFF(1),e.k0s()),2&n){const t=e.XpG(3);e.Y8G("valid",!1),e.R7$(1),e.SpI(" ",t.validationErrors.content," ")}}function ue(n,s){if(1&n){const t=e.RV6();e.j41(0,"form",7),e.bIt("ngSubmit",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.onSave())}),e.j41(1,"div",8)(2,"label",9),e.EFF(3,"Content"),e.k0s(),e.nrm(4,"editor",10),e.DNE(5,de,2,2,"c-form-feedback",11),e.k0s(),e.j41(6,"c-button-toolbar",12)(7,"c-button-group",13)(8,"button",14),e.EFF(9," Save "),e.k0s()()()()}if(2&n){const t=e.XpG(2);e.Y8G("formGroup",t.form),e.R7$(4),e.Y8G("init",t.init),e.R7$(1),e.Y8G("ngIf",t.validationErrors.content),e.R7$(3),e.Y8G("disabled",t.loading.post)}}function me(n,s){if(1&n&&(e.DNE(0,ce,3,1,"ng-container",4),e.DNE(1,ue,10,4,"form",5)),2&n){const t=e.XpG();e.Y8G("ngIf",!t.editInstance),e.R7$(1),e.Y8G("ngIf",t.editInstance)}}let fe=(()=>{class n extends I.H{constructor(t,i,o){super(t,i,o),this.articleInstance=null,this.onDocumentCreate=new e.bkB,this.action_urls={detail:a=>`/api/s/articles/${a}/content/`},this.init={},this.imagesUploadHandler=a=>{const c=a.blob();return Date.now(),a.filename(),new Promise((p,P)=>{this.uploadFileRequest(c).subscribe({next:k=>{p(k.url)},error:k=>{P(k)}})})},this.init={plugins:"lists link image table code help wordcount advcode ",toolbar:"undo redo | image code | lists link align",license_key:"gpl",promotion:!1,images_file_types:"jpg,svg,webp",file_picker_types:"image media",images_reuse_filename:!0,images_upload_handler:this.imagesUploadHandler}}uploadFileRequest(t){const i=new FormData;return i.append("file",t),i.append("type","attach"),this.http.post(`/api/s/articles/${this.articleInstance.id}/files/`,i).pipe((0,h.T)(o=>({...o})))}ngOnInit(){this.form=this.fb.group({content:[""]}),this.articleInstance&&this.fetchInstance(this.articleInstance.id)}patchFormValue(t){null!==this.editInstance&&this.form.patchValue({content:this.editInstance.content})}createInstance(){!this.editInstance&&this.articleInstance&&(this.loading.list=!0,this.loading.post=!0,this.http.post(`/api/s/articles/${this.articleInstance.id}/`,{title:"Document for "+this.articleInstance?.title,article:this.articleInstance.id}).subscribe({next:t=>{this.loading.list=!1,this.loading.post=!1,this.editInstance=t.data,this.patchFormValue(t.data),this.onDocumentCreate.emit(t.data)}}))}deleteInstance(){this.editInstance&&this.articleInstance&&(this.loading.list=!0,this.loading.post=!0,this.http.delete(`/api/s/articles/${this.articleInstance.id}/`).subscribe({next:t=>{this.loading.list=!1,this.loading.post=!1,this.editInstance=null,this.form.reset(),window.location.reload()}}))}static{this.\u0275fac=function(i){return new(i||n)(e.rXU(d.ok),e.rXU(C.I8),e.rXU(E.Qq))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["dashboard-document-edit-form"]],inputs:{articleInstance:"articleInstance"},outputs:{onDocumentCreate:"onDocumentCreate"},features:[e.Vt3],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["formOut",""],[1,"w-100","d-flex","justify-content-center"],["color","info"],[4,"ngIf"],["novalidate","",3,"formGroup","ngSubmit",4,"ngIf"],["cButton","","color","success","type","button",3,"disabled","click"],["novalidate","",3,"formGroup","ngSubmit"],[1,"form-group","mb-3"],["cLabel","","for","content"],["apiKey","test","formControlName","content",3,"init"],["class","d-block",3,"valid",4,"ngIf"],["aria-label","Toolbar with button groups","role","group"],["aria-label","Update","role","group",1,"me-2"],["cButton","","color","primary","type","submit",3,"disabled"],[1,"d-block",3,"valid"]],template:function(i,o){if(1&i&&(e.DNE(0,le,3,0,"ng-container",0),e.DNE(1,me,2,2,"ng-template",null,1,e.C5r)),2&i){const a=e.sdS(2);e.Y8G("ngIf",o.loading.list)("ngIfElse",a)}},dependencies:[m.bT,r._fv,r.Z7S,r.tnu,r.XW7,r.YJZ,d.qT,d.BC,d.cb,d.j4,d.JD,r.tIt,v]})}}return n})();const pe=["fileInput"];function he(n,s){if(1&n&&(e.j41(0,"c-form-feedback",15),e.EFF(1),e.k0s()),2&n){const t=e.XpG();e.Y8G("valid",!1),e.R7$(1),e.JRh(t.validationErrors.file)}}function ge(n,s){if(1&n&&(e.qex(0),e.nrm(1,"img",29),e.bVm()),2&n){const t=e.XpG().$implicit;e.R7$(1),e.Y8G("src",t.url,e.B4B)}}function _e(n,s){1&n&&(e.qSk(),e.nrm(0,"svg",30))}function be(n,s){if(1&n){const t=e.RV6();e.j41(0,"div",17)(1,"div",18)(2,"a",19),e.bIt("click",function(o){const c=e.eBV(t).$implicit,u=e.XpG(2);return e.Njj(u.deleteFile(o,c))}),e.qSk(),e.nrm(3,"svg",20),e.k0s(),e.joV(),e.j41(4,"div",21),e.DNE(5,ge,2,1,"ng-container",22),e.DNE(6,_e,1,0,"ng-template",null,23,e.C5r),e.k0s(),e.j41(8,"a",24),e.qSk(),e.nrm(9,"svg",25),e.k0s(),e.joV(),e.j41(10,"div",26)(11,"h5",27),e.EFF(12),e.k0s(),e.j41(13,"p",28)(14,"small"),e.EFF(15),e.k0s()()()()()}if(2&n){const t=s.$implicit,i=e.sdS(7),o=e.XpG(2);e.R7$(5),e.Y8G("ngIf",o.fileType(t))("ngIfElse",i),e.R7$(3),e.Y8G("href",t.url,e.B4B),e.R7$(4),e.JRh(t.name),e.R7$(3),e.JRh(t.size)}}function Ce(n,s){if(1&n&&(e.j41(0,"div",3),e.DNE(1,be,16,5,"div",16),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.Y8G("ngForOf",t.editInstance.files)}}let ve=(()=>{class n extends I.H{constructor(){super(...arguments),this.articleInstance=null,this.action_urls={detail:t=>`/api/s/articles/${t}/`},this.editInstance=null,this.previewFiles={}}ngOnInit(){this.articleInstance&&this.fetchInstance(this.articleInstance.id)}onFileChange(t){if(t.target.files.length>0){const i=t.target.files[0];this.editInstance&&(this.validationErrors={},this.loading.post=!0,this.uploadFileRequest(i).subscribe({next:o=>{this.fileInputElement.nativeElement.value="",this.afterRequestSuccess(o)},error:o=>{this.fileInputElement.nativeElement.value="",this.afterRequestError(o)}}))}}uploadFileRequest(t){const i=new FormData;return i.append("file",t),i.append("type","attach"),this.http.post(`/api/s/articles/${this.articleInstance.id}/files/`,i).pipe((0,h.T)(o=>({...o.data})))}deleteFile(t,i){return t?.preventDefault(),this.http.delete(`/api/s/articles/${this.articleInstance.id}/files/${i.id}`).subscribe({next:()=>{this.fetchInstance()}})}fileType(t){return[".jpg",".jpeg",".png"].includes(t.extension)?"image":null}static{this.\u0275fac=function(){let t;return function(o){return(t||(t=e.xGo(n)))(o||n)}}()}static{this.\u0275cmp=e.VBU({type:n,selectors:[["dashboard-document-file-edit-form"]],viewQuery:function(i,o){if(1&i&&e.GBs(pe,5),2&i){let a;e.mGM(a=e.lsd())&&(o.fileInputElement=a.first)}},inputs:{articleInstance:"articleInstance"},features:[e.Vt3],decls:20,vars:3,consts:[[1,"mb-3"],[1,"content"],[1,"container"],[1,"row"],[1,"col-12"],[1,"card-box"],[1,"w-100"],[1,"header-title","m-b-30"],["hidden","","type","file",3,"change"],["fileInput",""],[1,"d-flex"],["cButton","","color","primary",3,"disabled","click"],[1,"ms-3"],["class","d-block",3,"valid",4,"ngIf"],["class","row",4,"ngIf"],[1,"d-block",3,"valid"],["class","col-lg-3 col-xl-2",4,"ngFor","ngForOf"],[1,"col-lg-3","col-xl-2"],[1,"file-man-box"],["href","#",1,"file-close",3,"click"],["cIcon","","name","cilDelete"],[1,"file-img-box"],[4,"ngIf","ngIfElse"],["inactive",""],[1,"file-download",3,"href"],["cIcon","","name","cilCloudDownload"],[1,"file-man-title"],[1,"mb-0","text-overflow"],[1,"mb-0"],[3,"src"],["cIcon","","name","cilFile"]],template:function(i,o){if(1&i){const a=e.RV6();e.j41(0,"c-row",0)(1,"div")(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"div",3)(8,"div",6)(9,"h4",7),e.EFF(10,"My Files"),e.k0s(),e.j41(11,"input",8,9),e.bIt("change",function(u){return o.onFileChange(u)}),e.k0s(),e.j41(13,"div",10)(14,"button",11),e.bIt("click",function(){e.eBV(a);const u=e.sdS(12);return e.Njj(u.click())}),e.EFF(15," Upload "),e.k0s(),e.j41(16,"div",12),e.DNE(17,he,2,2,"c-form-feedback",13),e.k0s()()()(),e.DNE(18,Ce,2,1,"div",14),e.k0s()()()()()(),e.nrm(19,"c-col"),e.k0s()}2&i&&(e.R7$(14),e.Y8G("disabled",o.loading.post),e.R7$(3),e.Y8G("ngIf",o.validationErrors.file),e.R7$(1),e.Y8G("ngIf",o.editInstance))},dependencies:[y.LJ,m.Sq,m.bT,r.gLf,r.oMR,r._fv,r.XW7],styles:[".card-box[_ngcontent-%COMP%]{padding:20px;border-radius:3px;margin-bottom:30px;background-color:#fff}.file-man-box[_ngcontent-%COMP%]{padding:20px;border:1px solid #e3eaef;border-radius:5px;position:relative;margin-bottom:20px}.file-man-box[_ngcontent-%COMP%]   .file-close[_ngcontent-%COMP%]{color:#f1556c;position:absolute;line-height:24px;font-size:24px;right:10px;top:10px;visibility:hidden}.file-man-box[_ngcontent-%COMP%]   .file-img-box[_ngcontent-%COMP%]{line-height:120px;text-align:center}.file-man-box[_ngcontent-%COMP%]   .file-img-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:64px}.file-man-box[_ngcontent-%COMP%]   .file-download[_ngcontent-%COMP%]{font-size:32px;color:#98a6ad;position:absolute;right:10px}.file-man-box[_ngcontent-%COMP%]   .file-download[_ngcontent-%COMP%]:hover{color:#313a46}.file-man-box[_ngcontent-%COMP%]   .file-man-title[_ngcontent-%COMP%]{padding-right:25px}.file-man-box[_ngcontent-%COMP%]:hover{box-shadow:0 0 24px #0000000f,0 1px #00000005}.file-man-box[_ngcontent-%COMP%]:hover   .file-close[_ngcontent-%COMP%]{visibility:visible}.text-overflow[_ngcontent-%COMP%]{text-overflow:ellipsis;white-space:nowrap;display:block;width:100%;overflow:hidden}h5[_ngcontent-%COMP%]{font-size:15px}"]})}}return n})();function Ie(n,s){1&n&&(e.qex(0),e.j41(1,"div",3),e.nrm(2,"c-spinner",4),e.k0s(),e.bVm())}function Ee(n,s){1&n&&(e.j41(0,"c-form-feedback",23),e.EFF(1," Title is required. "),e.k0s()),2&n&&e.Y8G("valid",!1)}function ke(n,s){if(1&n&&(e.j41(0,"div"),e.DNE(1,Ee,2,1,"c-form-feedback",18),e.k0s()),2&n){const t=e.XpG(3);e.R7$(1),e.Y8G("ngIf",t.formControl.title.errors.required&&t.formControl.title.touched)}}function xe(n,s){if(1&n&&(e.j41(0,"c-form-feedback",23),e.EFF(1),e.k0s()),2&n){const t=e.XpG(3);e.Y8G("valid",!1),e.R7$(1),e.SpI(" ",t.validationErrors.title," ")}}function ye(n,s){if(1&n&&(e.j41(0,"c-form-feedback",23),e.EFF(1),e.k0s()),2&n){const t=e.XpG(3);e.Y8G("valid",!1),e.R7$(1),e.JRh(t.validationErrors.subject_id)}}function we(n,s){if(1&n&&(e.j41(0,"c-form-feedback",23),e.EFF(1),e.k0s()),2&n){const t=e.XpG(4);e.Y8G("valid",!1),e.R7$(1),e.JRh(t.validationErrors.featured_image)}}function De(n,s){if(1&n&&(e.j41(0,"div",30),e.nrm(1,"img",31),e.k0s()),2&n){const t=e.XpG(4);e.R7$(1),e.Y8G("src",t.editInstance.featured_image.url,e.B4B)}}function Be(n,s){if(1&n){const t=e.RV6();e.j41(0,"button",32),e.bIt("click",function(){e.eBV(t);const o=e.XpG(4);return e.Njj(o.deleteFile(o.editInstance.featured_image))}),e.EFF(1," Delete "),e.k0s()}}function Fe(n,s){if(1&n){const t=e.RV6();e.j41(0,"div",24)(1,"c-row")(2,"c-col",25)(3,"div",14)(4,"label",26),e.EFF(5,"Thumbnail Image"),e.k0s(),e.j41(6,"input",27),e.bIt("change",function(o){e.eBV(t);const a=e.XpG(3);return e.Njj(a.onFeaturedImageChange(o))}),e.k0s(),e.DNE(7,we,2,2,"c-form-feedback",18),e.k0s(),e.DNE(8,De,2,1,"div",28),e.DNE(9,Be,2,0,"button",29),e.k0s()()()}if(2&n){const t=e.XpG(3);e.R7$(7),e.Y8G("ngIf",t.validationErrors.featured_image),e.R7$(1),e.Y8G("ngIf",t.editInstance.featured_image&&(null==t.editInstance.featured_image?null:t.editInstance.featured_image.url)),e.R7$(1),e.Y8G("ngIf",t.editInstance.featured_image&&(null==t.editInstance.featured_image?null:t.editInstance.featured_image.url))}}function Re(n,s){if(1&n){const t=e.RV6();e.j41(0,"form",13),e.bIt("ngSubmit",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.onSave())}),e.j41(1,"div",14)(2,"label",15),e.EFF(3,"Title"),e.k0s(),e.nrm(4,"input",16),e.DNE(5,ke,2,1,"div",17),e.DNE(6,xe,2,2,"c-form-feedback",18),e.k0s(),e.j41(7,"div",14)(8,"label",19),e.EFF(9,"Subject"),e.k0s(),e.nrm(10,"app-filterable-multiselect",20),e.DNE(11,ye,2,2,"c-form-feedback",18),e.k0s(),e.j41(12,"button",21),e.EFF(13," Save "),e.k0s()(),e.DNE(14,Fe,10,3,"div",22)}if(2&n){const t=e.XpG(2);e.Y8G("formGroup",t.form),e.R7$(5),e.Y8G("ngIf",t.formControl.title.errors),e.R7$(1),e.Y8G("ngIf",t.validationErrors.title),e.R7$(4),e.Y8G("idField","id")("textField","title")("allowRemoteDataSearch",!0)("useInitialLoad",!0)("filterMethod",t.fetchFilterRequest.subjects)("multiple",!1),e.R7$(1),e.Y8G("ngIf",t.validationErrors.subject_id),e.R7$(1),e.Y8G("disabled",t.loading.post),e.R7$(2),e.Y8G("ngIf",t.editInstance)}}function je(n,s){if(1&n){const t=e.RV6();e.j41(0,"dashboard-document-edit-form",33),e.bIt("onDocumentCreate",function(o){e.eBV(t);const a=e.XpG(2);return e.Njj(a.onDocumentCreate(o))}),e.k0s()}if(2&n){const t=e.XpG(2);e.Y8G("articleInstance",t.editInstance)}}function Se(n,s){if(1&n&&e.nrm(0,"dashboard-document-file-edit-form",34),2&n){const t=e.XpG(2);e.Y8G("articleInstance",t.editInstance)}}function Ge(n,s){if(1&n){const t=e.RV6();e.j41(0,"c-card",5)(1,"c-card-header"),e.EFF(2),e.k0s(),e.j41(3,"c-card-body")(4,"ul",6,7),e.bIt("activeIdChange",function(o){e.eBV(t);const a=e.XpG();return e.Njj(a.tab_index=o)})("activeIdChange",function(o){e.eBV(t);const a=e.XpG();return e.Njj(a.onTabIndexChange(o))}),e.j41(6,"li",8)(7,"button",9),e.EFF(8,"Article"),e.k0s(),e.DNE(9,Re,15,12,"ng-template",10),e.k0s(),e.j41(10,"li",11)(11,"button",9),e.EFF(12,"Content"),e.k0s(),e.DNE(13,je,1,1,"ng-template",10),e.k0s(),e.j41(14,"li",11)(15,"button",9),e.EFF(16,"Files"),e.k0s(),e.DNE(17,Se,1,1,"ng-template",10),e.k0s()(),e.nrm(18,"div",12),e.k0s()()}if(2&n){const t=e.sdS(5),i=e.XpG();e.R7$(2),e.SpI("Article #",null==i.editInstance?null:i.editInstance.id,""),e.R7$(2),e.Y8G("activeId",i.tab_index),e.R7$(2),e.Y8G("ngbNavItem",1),e.R7$(4),e.Y8G("ngbNavItem",2)("disabled",!i.editInstance),e.R7$(4),e.Y8G("ngbNavItem",3)("disabled",!i.editInstance),e.R7$(4),e.Y8G("ngbNavOutlet",t)}}const $="TAB_INDEX_KEY";let N=(()=>{class n extends I.H{constructor(t,i,o,a,c){super(t,i,o),this.activatedRoute=a,this.router=c,this.tab_index=1,this.action_urls={detail:u=>`/api/s/articles/${u}/`,post:()=>"/api/s/articles/"},this.editInstance=null,this.previewFiles={},this.fetchFilterRequest={subjects:u=>this.http.get("/api/s/subjects",{params:{...u}}).pipe((0,h.T)(p=>p.results||[]))}}ngOnInit(){this.form=this.fb.group({title:["",d.k0.required],subject:[[]]}),this.activatedRoute.params.subscribe(t=>{const i=t.id;if(i&&(this.fetchInstance(i),i)){const o=localStorage.getItem($)||null;this.tab_index=null===o?1:Number(o)}})}afterRequestSuccess(t){this.loading.post=!1,this.validationErrors={},null===this.editInstance?this.router.navigate(["/","dashboard","articles",t.id,"edit"]):this.fetchInstance(t.id)}patchFormValue(t){null!==this.editInstance&&this.form.patchValue({title:this.editInstance.title,subject:this.editInstance.subject?[this.editInstance.subject]:[]})}getPreparedEditData(t){return t.subject_id=t.subject.length>0?t.subject[0].id:null,t}onTabIndexChange(t){localStorage.setItem($,t.toString())}onDocumentCreate(t){t&&this.fetchInstance()}onFeaturedImageChange(t){t.target.files.length>0&&this.editInstance&&this.uploadFileRequest(t.target.files[0]).subscribe({next:o=>{this.loading.list=!1,this.loading.post=!1,this.fetchInstance()}})}uploadFileRequest(t){const i=new FormData;return i.append("file",t),i.append("type","featured_image"),this.http.post(`/api/s/articles/${this.editInstance?.id}/files/`,i).pipe((0,h.T)(o=>({...o.data})))}deleteFile(t){return this.http.delete(`/api/s/articles/${this.editInstance?.id}/files/${t.id}`).subscribe({next:()=>{this.fetchInstance()}})}static{this.\u0275fac=function(i){return new(i||n)(e.rXU(d.ok),e.rXU(C.I8),e.rXU(E.Qq),e.rXU(g.nX),e.rXU(g.Ix))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["dashboard-article-edit"]],features:[e.Vt3],decls:5,vars:2,consts:[["xs",""],[4,"ngIf","ngIfElse"],["formOut",""],[1,"w-100","d-flex","justify-content-center"],["color","info"],[1,"mb-4"],["ngbNav","",1,"nav-tabs",3,"activeId","activeIdChange"],["nav","ngbNav"],[3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],[3,"ngbNavItem","disabled"],[1,"mt-2",3,"ngbNavOutlet"],["novalidate","",3,"formGroup","ngSubmit"],[1,"form-group","mb-3"],["cLabel","","for","title"],["cFormControl","","id","title","formControlName","title","type","text"],[4,"ngIf"],["class","d-block",3,"valid",4,"ngIf"],["cLabel","","for","subject"],["formControlName","subject","id","subject",3,"idField","textField","allowRemoteDataSearch","useInitialLoad","filterMethod","multiple"],["cButton","","color","primary","type","submit",3,"disabled"],["class","mt-5",4,"ngIf"],[1,"d-block",3,"valid"],[1,"mt-5"],["md","6"],["cLabel","","for","featured_image"],["cFormControl","","id","featured_image","placeholder","Upload file","accept","image/png, image/gif, image/jpeg","type","file",3,"change"],["class","w-100",4,"ngIf"],["cButton","","color","danger",3,"click",4,"ngIf"],[1,"w-100"],["alt","",1,"w-100","img-thumbnail",3,"src"],["cButton","","color","danger",3,"click"],[3,"articleInstance","onDocumentCreate"],[3,"articleInstance"]],template:function(i,o){if(1&i&&(e.j41(0,"c-row")(1,"c-col",0),e.DNE(2,Ie,3,0,"ng-container",1),e.DNE(3,Ge,19,8,"ng-template",null,2,e.C5r),e.k0s()()),2&i){const a=e.sdS(4);e.R7$(2),e.Y8G("ngIf",o.loading.list)("ngIfElse",a)}},dependencies:[m.bT,r.gLf,r.oMR,r._fv,f.Um,f.X9,f.sy,f.Gx,f.RI,f.WA,f.m_,r.l_X,r.XW7,r.YJZ,d.qT,d.me,d.BC,d.cb,re.D,d.j4,d.JD,r.iby,r.qHy,r.lMi,r.tIt,fe,ve]})}}return n})();var Me=l(1708);function Te(n,s){if(1&n&&(e.j41(0,"td"),e.nrm(1,"img",4),e.k0s()),2&n){const t=s.$implicit;e.R7$(1),e.Y8G("src",null==t.featured_image?null:t.featured_image.url,e.B4B)}}function $e(n,s){if(1&n&&(e.j41(0,"div",6),e.EFF(1),e.k0s()),2&n){const t=s.$implicit;e.R7$(1),e.SpI(" ",t.title," ")}}function Ne(n,s){if(1&n&&(e.j41(0,"td"),e.DNE(1,$e,2,1,"div",5),e.k0s()),2&n){const t=s.$implicit;e.R7$(1),e.Y8G("ngForOf",t.tags)}}const Pe=[{path:"list",component:(()=>{class n{constructor(t,i){this.http=t,this.router=i,this.table_title="Articles",this.actions={list:{use:!0,url:()=>"/api/s/articles/"},edit:{use:!0,redirectUrl:o=>`/dashboard/articles/${o?.id}/edit`},delete:{use:!0,url:o=>`/api/s/articles/${o}/`},create:{use:!0,redirectUrl:()=>"/dashboard/articles/edit"}},this.columns=[{header:"Id",field:"id",sortable:!0,filter:{type:"text"}},{header:"Title",field:"title",filter:{type:"text"}},{header:"Subject",field:"subject",filter:{type:"select",fetch:{useInitital:!0,action:()=>this.http.get("/api/s/subjects").pipe((0,h.T)(o=>o.results||[])),label_field:"title",value_field:"id"}},render:o=>o.subject?.title},{header:"Featured Image",field:"featured_image"},{header:"Created At",field:"created_at",sortable:!0,filter:{type:"date"}},{header:"Updated At",field:"updated_at",sortable:!0,filter:{type:"date"}}]}static{this.\u0275fac=function(i){return new(i||n)(e.rXU(E.Qq),e.rXU(g.Ix))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["dashboard-article-list"]],decls:5,vars:3,consts:[[3,"title","actions","columns"],["columnDef","featured_image"],["headerCellDef",""],["columnDef","tags"],["alt","featured_image",1,"smart-table__img",3,"src"],["class","btn mr-1 mb-1",4,"ngFor","ngForOf"],[1,"btn","mr-1","mb-1"]],template:function(i,o){1&i&&(e.j41(0,"dashboard-base-list",0),e.DNE(1,Te,2,1,"ng-template",1,2,e.C5r),e.DNE(3,Ne,2,1,"ng-template",3,2,e.C5r),e.k0s()),2&i&&e.Y8G("title",o.table_title)("actions",o.actions)("columns",o.columns)},dependencies:[m.Sq,Me.p]})}}return n})(),data:{title:$localize`Articles`}},{path:":id/edit",component:N,data:{title:$localize`Articles Edit`}},{path:"edit",component:N,data:{title:$localize`Articles Edit`}}];let Oe=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=e.$C({type:n})}static{this.\u0275inj=e.G2t({providers:[{provide:T,useValue:"tinymce/tinymce.min.js"}],imports:[y.op,r.jr_,m.MD,r.pc9,r.Emn,r.tmq,r.mCO,f.Pv,r.ayw,r.Q_q,r.tHK,d.YN,C.Q_.forRoot(),A.K,O.I,g.iI.forChild(Pe),d.X1,r.Dw2,r.pc9,r.EJq,r.Zic,r.OTD,ae.W,se]})}}return n})()}}]);