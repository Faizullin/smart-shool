import{i as y,Q as C,j as t,S as N,U as ne,V as k,W as se,X as F,Y as re,Z as oe,_,a0 as P,a1 as L,a2 as le,a3 as ie,a4 as B,a5 as E,a6 as R,a7 as ce,M as j,F as T,E as de,z as ue,O as be,e as me,b as fe,R as v,a8 as xe,o as pe,$ as he}from"./index-33e0424c.js";import{C as ve,a as ye,L as ge,P as Ee,b as je,p as Ce,c as Ne,d as Te,e as _e}from"./index-836a7b52.js";import{C as Me}from"./CardHeaderContext-7b099acd.js";import{E as O}from"./ExamService-168f40dd.js";var I={exports:{}},w={exports:{}};(function(e,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=r;function r(i){function l(c,u,b,h,p,s){var n=h||"<<anonymous>>",d=s||b;if(u[b]==null)return c?new Error("Required "+p+" `"+d+"` was not specified "+("in `"+n+"`.")):null;for(var f=arguments.length,m=Array(f>6?f-6:0),x=6;x<f;x++)m[x-6]=arguments[x];return i.apply(void 0,[u,b,n,p,d].concat(m))}var o=l.bind(null,!1);return o.isRequired=l.bind(null,!0),o}e.exports=a.default})(w,w.exports);var ke=w.exports;(function(e,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=o;var r=ke,i=l(r);function l(c){return c&&c.__esModule?c:{default:c}}function o(){for(var c=arguments.length,u=Array(c),b=0;b<c;b++)u[b]=arguments[b];function h(){for(var p=arguments.length,s=Array(p),n=0;n<p;n++)s[n]=arguments[n];var d=null;return u.forEach(function(f){if(d==null){var m=f.apply(void 0,s);m!=null&&(d=m)}}),d}return(0,i.default)(h)}e.exports=a.default})(I,I.exports);const D=y.forwardRef(({className:e,bsPrefix:a,as:r="div",...i},l)=>(a=C(a,"nav-item"),t.jsx(r,{ref:l,className:N(e,a),...i})));D.displayName="NavItem";const U=D,H=y.forwardRef(({bsPrefix:e,className:a,as:r=se,active:i,eventKey:l,disabled:o=!1,...c},u)=>{e=C(e,"nav-link");const[b,h]=ne({key:k(l,c.href),active:i,disabled:o,...c});return t.jsx(r,{...c,...b,ref:u,disabled:o,className:N(a,e,o&&"disabled",h.isActive&&"active")})});H.displayName="NavLink";const q=H,W=y.forwardRef((e,a)=>{const{as:r="div",bsPrefix:i,variant:l,fill:o=!1,justify:c=!1,navbar:u,navbarScroll:b,className:h,activeKey:p,...s}=F(e,{activeKey:"onSelect"}),n=C(i,"nav");let d,f,m=!1;const x=y.useContext(re),g=y.useContext(Me);return x?(d=x.bsPrefix,m=u??!0):g&&({cardHeaderBsPrefix:f}=g),t.jsx(oe,{as:r,ref:a,activeKey:p,className:N(h,{[n]:!m,[`${d}-nav`]:m,[`${d}-nav-scroll`]:m&&b,[`${f}-${l}`]:!!f,[`${n}-${l}`]:!!l,[`${n}-fill`]:o,[`${n}-justified`]:c}),...s})});W.displayName="Nav";const Oe=Object.assign(W,{Item:U,Link:q}),we=["active","eventKey","mountOnEnter","transition","unmountOnExit","role","onEnter","onEntering","onEntered","onExit","onExiting","onExited"],Se=["activeKey","getControlledId","getControllerId"],Pe=["as"];function S(e,a){if(e==null)return{};var r={},i=Object.keys(e),l,o;for(o=0;o<i.length;o++)l=i[o],!(a.indexOf(l)>=0)&&(r[l]=e[l]);return r}function Y(e){let{active:a,eventKey:r,mountOnEnter:i,transition:l,unmountOnExit:o,role:c="tabpanel",onEnter:u,onEntering:b,onEntered:h,onExit:p,onExiting:s,onExited:n}=e,d=S(e,we);const f=y.useContext(_);if(!f)return[Object.assign({},d,{role:c}),{eventKey:r,isActive:a,mountOnEnter:i,transition:l,unmountOnExit:o,onEnter:u,onEntering:b,onEntered:h,onExit:p,onExiting:s,onExited:n}];const{activeKey:m,getControlledId:x,getControllerId:g}=f,M=S(f,Se),K=k(r);return[Object.assign({},d,{role:c,id:x(r),"aria-labelledby":g(r)}),{eventKey:r,isActive:a==null&&K!=null?k(m)===K:a,transition:l||M.transition,mountOnEnter:i??M.mountOnEnter,unmountOnExit:o??M.unmountOnExit,onEnter:u,onEntering:b,onEntered:h,onExit:p,onExiting:s,onExited:n}]}const Z=y.forwardRef((e,a)=>{let{as:r="div"}=e,i=S(e,Pe);const[l,{isActive:o,onEnter:c,onEntering:u,onEntered:b,onExit:h,onExiting:p,onExited:s,mountOnEnter:n,unmountOnExit:d,transition:f=L}]=Y(i);return t.jsx(_.Provider,{value:null,children:t.jsx(P.Provider,{value:null,children:t.jsx(f,{in:o,onEnter:c,onEntering:u,onEntered:b,onExit:h,onExiting:p,onExited:s,mountOnEnter:n,unmountOnExit:d,children:t.jsx(r,Object.assign({},l,{ref:a,hidden:!o,"aria-hidden":!o}))})})})});Z.displayName="TabPanel";const z=e=>{const{id:a,generateChildId:r,onSelect:i,activeKey:l,defaultActiveKey:o,transition:c,mountOnEnter:u,unmountOnExit:b,children:h}=e,[p,s]=le(l,o,i),n=ie(a),d=y.useMemo(()=>r||((m,x)=>n?`${n}-${x}-${m}`:null),[n,r]),f=y.useMemo(()=>({onSelect:s,activeKey:p,transition:c,mountOnEnter:u||!1,unmountOnExit:b||!1,getControlledId:m=>d(m,"tabpane"),getControllerId:m=>d(m,"tab")}),[s,p,c,u,b,d]);return t.jsx(_.Provider,{value:f,children:t.jsx(P.Provider,{value:s||null,children:h})})};z.Panel=Z;const G=z;function $(e){return typeof e=="boolean"?e?B:L:e}const Q=({transition:e,...a})=>t.jsx(G,{...a,transition:$(e)});Q.displayName="TabContainer";const $e=Q,V=y.forwardRef(({className:e,bsPrefix:a,as:r="div",...i},l)=>(a=C(a,"tab-content"),t.jsx(r,{ref:l,className:N(e,a),...i})));V.displayName="TabContent";const X=V,J=y.forwardRef(({bsPrefix:e,transition:a,...r},i)=>{const[{className:l,as:o="div",...c},{isActive:u,onEnter:b,onEntering:h,onEntered:p,onExit:s,onExiting:n,onExited:d,mountOnEnter:f,unmountOnExit:m,transition:x=B}]=Y({...r,transition:$(a)}),g=C(e,"tab-pane");return t.jsx(_.Provider,{value:null,children:t.jsx(P.Provider,{value:null,children:t.jsx(x,{in:u,onEnter:b,onEntering:h,onEntered:p,onExit:s,onExiting:n,onExited:d,mountOnEnter:f,unmountOnExit:m,children:t.jsx(o,{...c,ref:i,className:N(l,g,u&&"active")})})})})});J.displayName="TabPane";const ee=J,Ke={eventKey:E.oneOfType([E.string,E.number]),title:E.node.isRequired,disabled:E.bool,tabClassName:E.string,tabAttrs:E.object},te=()=>{throw new Error("ReactBootstrap: The `Tab` component is not meant to be rendered! It's an abstract component that is only valid as a direct Child of the `Tabs` Component. For custom tabs components use TabPane and TabsContainer directly")};te.propTypes=Ke;const A=Object.assign(te,{Container:$e,Content:X,Pane:ee});function Re(e){let a;return ce(e,r=>{a==null&&(a=r.props.eventKey)}),a}function Ie(e){const{title:a,eventKey:r,disabled:i,tabClassName:l,tabAttrs:o,id:c}=e.props;return a==null?null:t.jsx(U,{as:"li",role:"presentation",children:t.jsx(q,{as:"button",type:"button",eventKey:r,disabled:i,id:c,className:l,...o,children:a})})}const ae=e=>{const{id:a,onSelect:r,transition:i,mountOnEnter:l=!1,unmountOnExit:o=!1,variant:c="tabs",children:u,activeKey:b=Re(u),...h}=F(e,{activeKey:"onSelect"});return t.jsxs(G,{id:a,activeKey:b,onSelect:r,transition:$(i),mountOnEnter:l,unmountOnExit:o,children:[t.jsx(Oe,{...h,role:"tablist",as:"ul",variant:c,children:R(u,Ie)}),t.jsx(X,{children:R(u,p=>{const s={...p.props};return delete s.title,delete s.disabled,delete s.tabClassName,delete s.tabAttrs,t.jsx(ee,{...s})})})]})};ae.displayName="Tabs";const Ae=ae;function Fe(e){var r,i;const a=()=>{e.setShow!==void 0&&e.setShow(!1)};return t.jsxs(j,{show:e.show,onHide:a,children:[t.jsx(j.Header,{closeButton:!0,children:t.jsxs(j.Title,{children:[t.jsx(T,{id:"feedback",defaultMessage:"Feedback"}),(r=e.feedback_item)==null?void 0:r.updated_at]})}),t.jsx(j.Body,{children:(i=e.feedback_item)==null?void 0:i.content}),t.jsx(j.Footer,{children:t.jsx(de,{variant:"secondary",onClick:a,children:t.jsx(T,{id:"close",defaultMessage:"Close"})})})]})}const Le=[{label:"Excell",format:"xlsx"},{label:"Csv",format:"csv"}],Be=({intl:e})=>{me();const a=fe(),[r,i]=v.useState([]),[l,o]=v.useState(!1),[c,u]=v.useState(),b=s=>{O.fetchExamFeedback(s).then(n=>{u(n.data),o(!0)}).catch(n=>{n.response.status===404&&a(pe({type:"error",data:{code:404,message:"No feedback!"}}))})},h=async(s,n)=>{try{const d=await he.get(`/export/result/${n.format}/`,{responseType:"blob"}),f=new Blob([d.data],{type:"application/octet-stream"}),m=URL.createObjectURL(f),x=document.createElement("a");x.href=m,x.setAttribute("download",`filename.${n.format}`),document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(m)}catch(d){console.error("Failed to download file:",d)}},p=v.useMemo(()=>[{key:"id",title:"ID",sortable:!0,render:(s,n)=>t.jsx("th",{scope:"row",className:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white",children:s.id},n)},{key:"exam",title:e.formatMessage({id:"exam",defaultMessage:"Exam"}),render:(s,n)=>t.jsxs("td",{className:"px-6",children:[s.exam.id," (",s.exam.exam_type,")"]},n)},{key:"subject",title:e.formatMessage({id:"subject"}),render:(s,n)=>t.jsx("td",{className:"px-6",children:s.exam.subject},n)},{key:"practical_score",title:e.formatMessage({id:"practical_score",defaultMessage:"Practical Score"})},{key:"theory_score",title:e.formatMessage({id:"theory_score",defaultMessage:"Theory Score"})},{key:"total_score",title:e.formatMessage({id:"total_score",defaultMessage:"Theory score"})},{key:"actions",title:e.formatMessage({id:"actions"}),render:(s,n)=>t.jsx("td",{className:"px-6 py-4 text-right",children:t.jsxs("button",{onClick:d=>b(s.exam.id),className:"relative font-medium bg-transparent hover:bg-blue-500 text-blue-700 font-semibold hover:text-white py-1 px-2 border border-blue-500 hover:border-transparent rounded mx-1 my-1",children:[t.jsx(T,{id:"dashboard.results_show_feedback",defaultMessage:"Show feedback"}),!s.feedback_watched&&t.jsx("div",{className:"absolute w-7 h-7 transform -translate-x-1/2 -translate-y-1/2 rounded-full top-0 left-0 bg-red-500"})]})},n)}],[]);return v.useEffect(()=>{O.fetchResultsMy().then(s=>{i(s.data)})},[]),t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"btn-group",role:"group",children:Le.map((s,n)=>t.jsx("button",{type:"button",onClick:()=>h("result",{format:s.format}),className:"btn btn-secondary",children:s.label},n))}),t.jsx("div",{className:"overflow-x-auto",children:t.jsx(xe,{data:r,columns:p})}),t.jsx(Fe,{show:l,setShow:o,feedback_item:c})]})},De={responsive:!0,plugins:{legend:{position:"top"},title:{display:!0,text:"Scores data"}},scales:{y:{beginAtZero:!0,max:100}}};ve.register(ye,ge,Ee,je,Ce,Ne,Te);function Ue({intl:e}){const[a,r]=v.useState(""),[i]=v.useState(""),[l]=v.useState(""),[o,c]=v.useState({theory_score:[],practical_score:[],total_score:[]}),[u,b]=v.useState([]),h=[{label:e.formatMessage({id:"year",defaultMessage:"Year"}),field:"year"},{label:e.formatMessage({id:"month",defaultMessage:"Month"}),field:"month"},{label:e.formatMessage({id:"day",defaultMessage:"Day"}),field:"day"},{label:e.formatMessage({id:"recent",defaultMessage:"Recent"}),field:""}],p=v.useMemo(()=>({labels:u,datasets:[{label:e.formatMessage({id:"theory_score"}),data:o.theory_score,borderColor:"rgb(255, 99, 132)",backgroundColor:"rgba(255, 99, 132, 0.5)"},{label:e.formatMessage({id:"practical_score"}),data:o.practical_score,borderColor:"rgb(20, 143, 119)",backgroundColor:"rgba(20, 143, 119, 0.5)"},{label:e.formatMessage({id:"total_score"}),data:o.total_score,borderColor:"rgb(53, 162, 235)",backgroundColor:"rgba(53, 162, 235, 0.5)"}]}),[o]),s=n=>{O.fetchResultsStatsMy(n).then(d=>{const f=d.data.chart_data,m={theory_score:[],practical_score:[],total_score:[]};for(let x=0;x<f.length;x++){const g=f[x];m.theory_score.push(g.theory_score),m.practical_score.push(g.practical_score),m.total_score.push(g.total_score)}b(f.map(x=>x.date)),c(m)})};return v.useEffect(()=>{s({group_by:a,start_date:i,end_date:l})},[a,i,l]),t.jsxs("div",{children:[t.jsx("div",{className:"btn-group",role:"group",children:h.map((n,d)=>t.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>r(n.field),children:t.jsx(T,{id:n.label})},d))}),t.jsx("div",{className:"overflow-x-auto",children:t.jsx(_e,{options:De,data:p})})]})}function Ze(){const e=ue(),a=[{label:e.formatMessage({id:"dashboard.results_table",defaultMessage:"Table"})},{label:e.formatMessage({id:"dashboard.results_stats",defaultMessage:"Statistics"})}];return t.jsxs("div",{className:"row",children:[t.jsx(be,{}),t.jsx("div",{className:"col-lg-8",children:t.jsx("div",{className:"card mb-4",children:t.jsx("div",{className:"card-body",children:t.jsxs(Ae,{defaultActiveKey:"table",id:"uncontrolled-tab",className:"mb-3",children:[t.jsx(A,{eventKey:"table",title:a[0].label,children:t.jsx(Be,{intl:e})}),t.jsx(A,{eventKey:"statistics",title:a[1].label,children:t.jsx(Ue,{intl:e})})]})})})})]})}export{Ze as default};
