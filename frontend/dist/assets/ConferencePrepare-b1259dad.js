import{a as y,d as C,y as N,b as x,R as r,P,e as k,B as o,C as h,j as e,F as c,D as l}from"./index-9c02b3eb.js";/* empty css                  */const B=()=>{const d=y(),j=C(),p=N(),{conference_payload:t,loading:E}=x(s=>s.conference);x(s=>s.auth);const[i,f]=r.useState(null),[D,g]=r.useState(null),v=P(),[m,u]=r.useState(!1),{id:n}=k(),w=async()=>{try{const s={video:!0,audio:!0},a=await navigator.mediaDevices.getUserMedia(s);f(a)}catch(s){console.error("Error accessing webcam or microphone:",s)}},b=()=>{i&&i.getTracks().forEach(a=>a.stop()),f(null),g(null)},S=()=>{(t==null?void 0:t.status)!=="completed"?j(`/conference/${n}/room`):v.show({headerContent:"Bootstrap",bodyContent:p.formatMessage({id:"conference.alert_session_stpped"}),toastProps:{bg:"info"}})};return r.useEffect(()=>{n&&d(o(Number(n))).then(s=>{if(s.type===o.fulfilled.toString()){const a=h.getConferenceState();a.ready&&((a==null?void 0:a.id)===s.payload.id?u(!0):u(!1))}else s.type===o.rejected.toString()&&alert("You dont have permission to join")})},[d,n]),r.useEffect(()=>{m&&h.setConferenceState({...t,ready:!0})},[m]),e.jsx("main",{className:"d-flex flex-column flex-grow-1",children:e.jsx("section",{className:"bg-green-light d-flex flex-column flex-grow-1",children:e.jsx("div",{className:"clients d-flex flex-column flex-grow-1",children:e.jsxs("div",{className:"container d-flex flex-column flex-grow-1",children:[e.jsx("h3",{className:"mb-3",children:e.jsx(c,{id:"conference.prep_title"})}),e.jsx("h3",{className:"mb-4",children:t==null?void 0:t.title}),e.jsx("div",{className:"mb-3",children:i?e.jsx("video",{className:"w-100",autoPlay:!0,playsInline:!0,ref:s=>{s&&(s.srcObject=i)}}):e.jsx(l,{variant:"primary",onClick:w,children:e.jsx(c,{id:"conference.start_webcam_prview"})})}),e.jsxs("div",{className:"mb-5 d-flex justify-content-between",children:[e.jsx(l,{variant:"secondary",onClick:b,children:e.jsx(c,{id:"conference.stop_webcam_prview"})}),e.jsx(l,{variant:"success",onClick:S,children:e.jsx(c,{id:"join"})})]}),e.jsx("div",{children:e.jsx("p",{children:t==null?void 0:t.description})})]})})})})};export{B as default};
