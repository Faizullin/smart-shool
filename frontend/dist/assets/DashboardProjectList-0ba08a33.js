import{g as I,h as L,R as S,a8 as D,j as e,M as E,F as P,a9 as T,aa as W,D as M,A as R,ag as _,d as F,a as B,y as $,N as K,K as U,I as z,ah as q,o as H}from"./index-9c02b3eb.js";var V=function(i){var f={};function r(n){if(f[n])return f[n].exports;var s=f[n]={i:n,l:!1,exports:{}};return i[n].call(s.exports,s,s.exports,r),s.l=!0,s.exports}return r.m=i,r.c=f,r.d=function(n,s,g){r.o(n,s)||Object.defineProperty(n,s,{enumerable:!0,get:g})},r.r=function(n){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},r.t=function(n,s){if(1&s&&(n=r(n)),8&s||4&s&&typeof n=="object"&&n&&n.__esModule)return n;var g=Object.create(null);if(r.r(g),Object.defineProperty(g,"default",{enumerable:!0,value:n}),2&s&&typeof n!="string")for(var a in n)r.d(g,a,(function(b){return n[b]}).bind(null,a));return g},r.n=function(n){var s=n&&n.__esModule?function(){return n.default}:function(){return n};return r.d(s,"a",s),s},r.o=function(n,s){return Object.prototype.hasOwnProperty.call(n,s)},r.p="",r(r.s=2)}([function(i,f){i.exports=L},function(i,f,r){i.exports=r(3)()},function(i,f,r){r.r(f);var n=r(0),s=r.n(n),g=r(1),a=r.n(g);function b(c){return function(t){if(Array.isArray(t))return v(t)}(c)||function(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}(c)||function(t,u){if(t){if(typeof t=="string")return v(t,u);var p=Object.prototype.toString.call(t).slice(8,-1);if(p==="Object"&&t.constructor&&(p=t.constructor.name),p==="Map"||p==="Set")return Array.from(t);if(p==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(p))return v(t,u)}}(c)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function v(c,t){(t==null||t>c.length)&&(t=c.length);for(var u=0,p=new Array(t);u<t;u++)p[u]=c[u];return p}function j(c){return(j=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(c)}function w(c,t){for(var u=0;u<t.length;u++){var p=t[u];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(c,p.key,p)}}function k(c,t){return(k=Object.setPrototypeOf||function(u,p){return u.__proto__=p,u})(c,t)}function C(c){var t=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var u,p=h(c);if(t){var O=h(this).constructor;u=Reflect.construct(p,arguments,O)}else u=p.apply(this,arguments);return d(this,u)}}function d(c,t){return!t||j(t)!=="object"&&typeof t!="function"?function(u){if(u===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u}(c):t}function h(c){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(c)}var y=function(c){(function(l,o){if(typeof o!="function"&&o!==null)throw new TypeError("Super expression must either be null or a function");l.prototype=Object.create(o&&o.prototype,{constructor:{value:l,writable:!0,configurable:!0}}),o&&k(l,o)})(O,c);var t,u,p=C(O);function O(l){var o;return function(m,x){if(!(m instanceof x))throw new TypeError("Cannot call a class as a function")}(this,O),(o=p.call(this,l)).state={placeholder:o.props.placeholder,showDropdown:!1,selected:o.props.selected,options:[]},o}return t=O,(u=[{key:"setSelected",value:function(){}},{key:"setOptions",value:function(){var l=this;if(this.props.options.length!=0){var o=[];j(this.props.options[0])==="object"?this.props.options.map(function(m,x){var N=m[l.props.optionKey],A=m[l.props.optionLabel];o.push({key:N,label:A})}):typeof this.props.options[0]=="string"&&this.props.options.map(function(m){o.push({key:m,label:m})}),this.setState({options:o})}else console.log("React Dropdown Multiselect Error: options array is empty.")}},{key:"componentDidMount",value:function(){this.setOptions(),document.addEventListener("mousedown",this.handleClickOutside.bind(this))}},{key:"handleClickOutside",value:function(l){this.state.showDropdown!==!1&&this.node.contains(l.target)==0&&this.setState({showDropdown:!1})}},{key:"getPlaceholderValue",value:function(){if(this.state.selected.length==0)return this.props.placeholder;if(this.props.placeholderMultipleChecked!==null&&this.state.selected.length>1)return this.props.placeholderMultipleChecked;var l=b(this.state.options);if(l.length==0)return this.props.placeholder;var o=[];return this.props.optionKey,this.state.selected.map(function(m){var x=l.find(function(N){return N.key==m});o.push(x.label)}),o.join(", ")}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.handleClickOutside.bind(this))}},{key:"handleClick",value:function(){this.setState({showDropdown:!this.state.showDropdown})}},{key:"handleChange",value:function(l){if(l.currentTarget!==void 0){var o=b(this.state.selected),m=l.currentTarget.value;if(l.currentTarget.checked)o.push(m);else{var x=o.indexOf(m);o.splice(x,1)}this.setState({selected:o}),this.props.handleOnChange!==void 0&&this.props.handleOnChange(o)}}},{key:"handleSelectDeselectAll",value:function(){if(this.state.selected.length==this.state.options.length)this.setState({selected:[]}),this.props.handleOnChange!==void 0&&this.props.handleOnChange([]);else{var l=this.state.options,o=[];l.map(function(m){o.push(m.key.toString())}),this.setState({selected:o}),this.props.handleOnChange!==void 0&&this.props.handleOnChange(o)}}},{key:"render",value:function(){var l=this,o=this.state.showDropdown==1?"dropdown-menu show":"dropdown-menu";return s.a.createElement("div",{className:"dropdown",ref:function(m){return l.node=m}},s.a.createElement("button",{className:"btn dropdown-toggle ".concat(this.props.buttonClass),type:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",onClick:function(){return l.handleClick()},style:{width:"100%",overflow:"hidden"}},s.a.createElement("span",{style:{overflow:"hidden",textOverflow:"ellipsis",width:"100%",float:"left",textAlign:"left",paddingRight:"6px",marginRight:"-6px"}},this.getPlaceholderValue())),s.a.createElement("div",{className:o,style:{padding:0,width:"100%"}},this.props.showSelectToggle===!0&&s.a.createElement("div",{className:"btn-group btn-group-sm btn-block"},s.a.createElement("button",{className:"actions-btn btn btn-light",onClick:function(){return l.handleSelectDeselectAll()}},this.props.selectDeselectLabel)),this.state.options.map(function(m,x){return s.a.createElement("div",{key:x,className:"dropdown-item"},s.a.createElement("div",{className:"form-check"},s.a.createElement("input",{value:m.key,id:"multiselect-".concat(l.props.name,"-").concat(x),className:"form-check-input",type:"checkbox",name:"".concat(l.props.name,"[]"),onChange:function(N){return l.handleChange(N)},checked:l.state.selected.indexOf(m.key.toString())>-1?"checked":""}),s.a.createElement("label",{className:"form-check-label",style:{userSelect:"none",width:"100%"},htmlFor:"multiselect-".concat(l.props.name,"-").concat(x)},m.label)))})))}}])&&w(t.prototype,u),O}(s.a.Component);y.propTypes={buttonClass:a.a.string,selected:a.a.array,value:a.a.array,placeholder:a.a.string,selectDeselectLabel:a.a.string,placeholderMultipleChecked:a.a.string,options:a.a.array.isRequired,name:a.a.string.isRequired,showSelectToggle:a.a.bool,optionKey:a.a.string,optionLabel:a.a.string},y.defaultProps={placeholder:"Nothing selected",selectDeselectLabel:"Select/Deselect All",buttonClass:"btn-light",placeholderMultipleChecked:null,selected:[],showSelectToggle:!0,optionKey:"key",optionLabel:"label"},f.default=y},function(i,f,r){var n=r(4);function s(){}function g(){}g.resetWarningCache=s,i.exports=function(){function a(j,w,k,C,d,h){if(h!==n){var y=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw y.name="Invariant Violation",y}}function b(){return a}a.isRequired=a;var v={array:a,bool:a,func:a,number:a,object:a,string:a,symbol:a,any:a,arrayOf:b,element:a,elementType:a,instanceOf:b,node:a,objectOf:b,oneOf:b,oneOfType:b,shape:b,exact:b,checkPropTypes:g,resetWarningCache:s};return v.PropTypes=v,v}},function(i,f,r){i.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}]);const G=I(V);function Y(i){const{project:f}=i,[r,n]=S.useState({shared_students:[]}),[s,g]=S.useState({shared_students_ids:null}),[a,b]=S.useState([]),[v,j]=S.useState({detail:!1,post:!1}),w=async d=>{d==null||d.preventDefault(),g({shared_students_ids:null}),j(h=>({...h,post:!0}));try{await D.fetchSaveProjectWorkSharedStudents(f.id,{...r})}catch(h){h instanceof R&&(h.response&&h.response.status===400?g(h.response.data):alert("An error occurred. "+h.response.status))}j(h=>({...h,post:!1}))},k=d=>{},C=()=>{i.setShow!==void 0&&i.setShow(!1)};return S.useEffect(()=>{f!==null&&(j(d=>({...d,detail:!0})),D.fetchProjectWorkSharedStudents(f.id).then(d=>{const h=d.data.shared_students||[];b(h.map(y=>{var c,t;return{label:`${(c=y.user)==null?void 0:c.username}(${(t=y.user)==null?void 0:t.email})`,value:y.id}}))}).finally(()=>{j(d=>({...d,detail:!1}))}))},[f]),e.jsxs(E,{show:i.show,onHide:C,children:[e.jsx(E.Header,{closeButton:!0,children:e.jsx(E.Title,{children:e.jsx(P,{id:"share"})})}),e.jsx(E.Body,{children:e.jsx(T,{onSubmit:w,children:e.jsxs(T.Group,{children:[e.jsx(G,{options:a,name:"countries",handleOnChange:k}),s.shared_students_ids&&e.jsx(W,{messages:s.shared_students_ids})]})})}),e.jsxs(E.Footer,{children:[e.jsx(M,{variant:"secondary",onClick:C,children:e.jsx(P,{id:"close",defaultMessage:"Close"})}),e.jsx(M,{variant:"primary",onClick:w,disabled:v.post,children:e.jsx(P,{id:"submit",defaultMessage:"Submit"})})]})]})}const J={dev:"Development",pending:"Pending",rated:"Rated"},Q=({project_item:i,onEditClick:f,onDeleteClick:r,onShareClick:n})=>{var s;return e.jsx("div",{className:"col-md-6",id:"project-items-1",children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex mb-3",children:[e.jsx("div",{className:"flex-grow-1 align-items-start",children:e.jsx("div",{children:e.jsxs("h6",{className:"mb-0 text-muted",children:[e.jsx("i",{className:"mdi mdi-circle-medium text-danger fs-3 align-middle"}),e.jsx("span",{className:"team-date",children:i.created_at})]})})}),e.jsxs(_,{className:"ms-2",children:[e.jsx(_.Toggle,{className:"font-size-16 text-muted bg-transparent border-0 p-0",children:e.jsx("i",{className:"mdi mdi-dots-horizontal"})}),e.jsxs(_.Menu,{align:"end",children:[e.jsx(_.Item,{onClick:()=>f(i.id),children:e.jsx(P,{id:"edit",defaultMessage:"Edit"})}),e.jsx("div",{className:"dropdown-divider"}),i.status!=="rated"&&e.jsx(_.Item,{onClick:()=>r(i.id),children:e.jsx(P,{id:"delete",defaultMessage:"Delete"})})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h5",{className:"mb-1 font-size-17 team-title",children:i.title}),e.jsx("p",{className:"text-muted mb-0 team-description",children:e.jsx(P,{id:"dashboard.projects.files_count_svadv",defaultMessage:"{files_count} files",values:{files_count:((s=i.files)==null?void 0:s.length)||0}})})]}),e.jsxs("div",{className:"d-flex",children:[e.jsx("div",{className:"avatar-group float-start flex-grow-1 task-assigne"}),i.status&&e.jsx("div",{className:"align-self-end",children:e.jsx("span",{className:`badge ${i.status==="pending"?"badge-soft-warning":(i.status==="dev","badge-soft-success")} p-2 team-status`,children:J[i.status]})})]})]})})})},Z=()=>{const i=F(),f=B(),r=$(),[n,s]=S.useState([]),[g,a]=S.useState(!1),[b,v]=S.useState(null),j=()=>{D.fetchProjectWorkList().then(d=>{s(d.data)})},w=d=>{if(d===void 0){const h=prompt(r.formatMessage({id:"dashboard.projects.sadva",defaultMessage:"The name of new project"}));h&&D.fetchCreateProjectWork({title:h}).then(y=>{window.open(`/dashboard/projects/${y.data.id}/edit`,"_blank"),j()}).catch(y=>{var c;y instanceof R&&y.response.status===403&&(c=y.response.data)!=null&&c.detail&&f(H({type:"error",data:{code:403,message:y.response.data.detail}}))})}else i(`/dashboard/projects/${d}/edit`)},k=d=>{D.fetchDeleteProjectWork(d).then(h=>{j()})},C=d=>{a(!0),v(d)};return S.useEffect(()=>{j()},[]),e.jsxs("div",{className:"row",children:[e.jsx(K,{}),e.jsx("div",{className:"col-lg-8",children:e.jsx("div",{className:"card projects-list",children:e.jsx("div",{className:"tab-content p-4",children:e.jsxs("div",{className:"tab-pane active show",id:"projects-tab",role:"tabpanel",children:[e.jsxs("div",{className:"d-flex align-items-start",children:[e.jsx("div",{className:"flex-1",children:e.jsx("h4",{className:"card-title mb-4",children:e.jsx(P,{id:"projects",defaultMessage:"Projects"})})}),e.jsx("div",{className:"flex-1 ms-4",children:e.jsx(U,{className:"p-0",onClick:()=>w(),children:e.jsx(z,{path:q,color:"#ffffff",size:1})})})]}),e.jsx("div",{className:"row",id:"all-projects",children:n.map(d=>e.jsx(Q,{project_item:d,onEditClick:w,onDeleteClick:k,onShareClick:C},d.id))})]})})})}),e.jsx(Y,{show:g,setShow:a,project:b})]})};export{Z as default};
