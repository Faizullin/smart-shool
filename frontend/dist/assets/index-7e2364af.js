import{R as o,a9 as g,j as e,M as m,F as c,a as _,aa as v,E as S,b as w,e as k,z as M,G as E,O as N,a8 as P,o as C}from"./index-33e0424c.js";import{E as z}from"./ExamService-168f40dd.js";function F(d){const{exam_id:l}=d,[i,x]=o.useState({project_id:-1,exam_id:-1}),[n,h]=o.useState({project_id:null,exam_id:null}),[j,p]=o.useState([]),[b,u]=o.useState({post:!1}),f=t=>{x(a=>({...a,project_id:t.target.value}))},s=t=>{t.preventDefault(),h({exam_id:null,project_id:null}),u(a=>({...a,post:!0})),g.fetchSubmitProjectWork({...i}).then(()=>{r(),u(a=>({...a,post:!1})),window.location.reload()}).catch(a=>{u(y=>({...y,post:!1})),a.response&&a.response.status===400?h(a.response.data):alert("An error occurred. "+a.response.status)})},r=()=>{d.setShow!==void 0&&d.setShow(!1)};return o.useEffect(()=>{x(t=>({...t,exam_id:l})),g.fetchProjectWorkList({status:"dev"}).then(t=>{p(t.data)})},[l]),e.jsxs(m,{show:d.show,onHide:r,children:[e.jsx(m.Header,{closeButton:!0,children:e.jsx(m.Title,{children:e.jsx(c,{id:"dashboard.exams.suuubcas",defaultMessage:"Submit project for Exam (#{exam_id}) ",values:{exam_id:l}})})}),e.jsx(m.Body,{children:e.jsx(_,{onSubmit:s,children:e.jsxs(_.Group,{children:[e.jsxs(_.Control,{as:"select",value:i.project_id,onChange:f,children:[e.jsx("option",{value:"",children:"----"}),j.map(t=>e.jsxs("option",{value:t.id,children:[t.title," (",t.status,")"]},t.id))]}),n.project_id&&e.jsx(v,{messages:n.project_id}),n.exam_id&&e.jsx(v,{messages:n.exam_id})]})})}),e.jsxs(m.Footer,{children:[e.jsx(S,{variant:"secondary",onClick:r,children:e.jsx(c,{id:"close",defaultMessage:"Close"})}),e.jsx(S,{variant:"primary",onClick:s,disabled:b.post,children:e.jsx(c,{id:"submit",defaultMessage:"Submit"})})]})]})}const q={i:"Initital",m:"Mid",f:"Final"};function L(){const d=w(),l=k(),i=M(),[x,n]=o.useState([]),[h,j]=o.useState(!1),p=o.useRef(null);o.useEffect(()=>{z.fetchExamsMy().then(s=>{n(s.data)})},[]);const b=s=>{l(`/quiz/${s}`)},u=s=>{s.theory_passed?(p.current=s.id,j(!0)):d(C({type:"error",data:{message:"Please pass theory test at first!"}}))},f=o.useMemo(()=>[{key:"id",title:"ID",render:(s,r)=>e.jsx("th",{scope:"row",className:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white",children:s.id},r)},{key:"exam_type",title:i.formatMessage({id:"dashboard.exams_exam_type",defaultMessage:"Exam Type"}),render:(s,r)=>e.jsx("td",{scope:"row",children:q[s.exam_type]},r)},{key:"subject",title:i.formatMessage({id:"subject"})},{key:"actions",title:i.formatMessage({id:"actions"}),render:(s,r)=>e.jsxs("td",{className:"px-6 py-4 text-right",children:[s.theory_passed?e.jsx("p",{className:"text-blue",children:e.jsx(c,{id:"passed",defaultMessage:"Passed"})}):s.quiz_id?e.jsx("button",{onClick:()=>b(s.quiz_id),className:"font-medium bg-transparent hover:bg-blue-500 text-blue-700 font-semibold hover:text-white py-1 px-2 border border-blue-500 hover:border-transparent rounded mx-1 my-1",children:e.jsx(c,{id:"dashboard.exams_start_quiz",defaultMessage:"Start quiz"})}):e.jsx("p",{className:"text-danger",children:"No quiz id "}),s.submitted_project_work?e.jsxs(E,{to:`/dashboard/projects/${s.submitted_project_work.id}/edit`,children:["Project ",s.submitted_project_work.title]}):e.jsx("button",{onClick:()=>u(s),className:"font-medium bg-transparent hover:bg-blue-500 text-blue-700 font-semibold hover:text-white py-1 px-2 border border-blue-500 hover:border-transparent rounded mx-1 my-1",children:e.jsx(c,{id:"dashboard.exams_submit_project",defaultMessage:"Submit project"})})]},r)}],[]);return e.jsxs("div",{className:"row",children:[e.jsx(N,{}),e.jsx("div",{className:"col-lg-8",children:e.jsx("div",{className:"card mb-4",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsx(P,{data:x,columns:f})})})})}),e.jsx(F,{show:h,setShow:j,exam_id:p.current})]})}export{L as default};
