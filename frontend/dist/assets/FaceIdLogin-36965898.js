import{b as j,e as g,i as p,j as e,T as w,F as i,G as v,M as c,E as b,d as F,J as x,o as N}from"./index-9951c21b.js";import{F as S,S as y}from"./FaceIdDetector-24450b0e.js";const D=({onSubmit:m,user_data:n})=>{const{errors:l}=F(a=>a.auth),[t,u]=p.useState({username:"",password:"",email:""}),o=a=>u(h=>({...h,[a.target.name]:a.target.value})),d=a=>{a.preventDefault(),m({username:t.email,password:t.password})};return p.useEffect(()=>{n&&n.username&&u(a=>({...a,username:n.username,email:n.email}))},[n]),e.jsxs("form",{onSubmit:d,children:[e.jsxs("div",{className:"row mb-4",children:[e.jsxs("div",{className:"col-6",children:[e.jsx("label",{htmlFor:"input-username",children:e.jsx(i,{id:"username"})}),e.jsx("input",{id:"input-username",type:"text",className:"form-control",name:"username",value:t.username,onChange:o,autoComplete:"username",readOnly:!0})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("label",{htmlFor:"input-email",children:"Email"}),e.jsx("input",{id:"input-email",type:"email",className:"form-control",name:"email",value:t.email,onChange:o,autoComplete:"current-password",readOnly:!0})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"input-password",children:e.jsx(i,{id:"password"})}),e.jsx("input",{id:"input-password",type:"password",className:"form-control",name:"password",value:t.password,onChange:o}),l.password&&e.jsx("div",{className:"invalid-feedback mt-2",children:l.password})]}),l.detail&&e.jsx("div",{className:"invalid-feedback d-block mb-3",children:l.detail}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:e.jsx(i,{id:"login"})})]})};function _(){const m=j(),n=g(),[l,t]=p.useState(!1),[u,o]=p.useState({email:"",username:""}),d=()=>t(!1),a=r=>{m(x(r)).then(s=>{s.type===x.fulfilled.toString()&&(d(),n("/dashboard/profile"))})},h=r=>{y.loginViaFace(r).then(s=>{o({email:s.data.email,username:s.data.username}),t(!0)}).catch(s=>{s.response.status&&s.response.data&&s.response.data.success===!1&&s.response.data.message&&m(N({type:"error",data:{code:s.response.status,message:s.response.data.message}}))})},f=r=>{const s=new FormData;s.append("image",r),h(s)};return e.jsxs("div",{className:"form-container",children:[e.jsx(w,{title:"Face-id Login"}),e.jsx("h3",{children:e.jsx(i,{id:"face_id.login_with_face_id",defaultMessage:"Login with face id"})}),e.jsx(S,{detectLimit:2,onFullDetect:f,delay_interval:300}),e.jsx("div",{className:"mt-3",children:e.jsxs("div",{className:"d-flex justify-content-between flex-wrap",children:[e.jsx(i,{id:"face_id.dvda",defaultMessage:"No face id provided?"}),e.jsx(v,{to:"/face_id/train",children:e.jsx(i,{id:"face_id.lets_train",defaultMessage:"Let's train"})})]})}),e.jsxs(c,{show:l,onHide:d,children:[e.jsx(c.Header,{closeButton:!0,children:e.jsx(c.Title,{children:"Login"})}),e.jsx(c.Body,{children:e.jsx(D,{onSubmit:a,user_data:u})}),e.jsx(c.Footer,{children:e.jsx(b,{variant:"secondary",onClick:d,children:e.jsx(i,{id:"close",defaultMessage:"Close"})})})]})]})}export{_ as default};
